{
  
    
        "post0": {
            "title": "1-1. ë¨¸ì‹ ëŸ¬ë‹ì„ ìœ„í•œ ì£¼ê°€ ë°ì´í„°ì…‹ ìƒì„±",
            "content": "1. Stock Prediction Part.1 - baseline model . 1-1. &#47672;&#49888;&#47084;&#45789;&#51012; &#50948;&#54620; &#51452;&#44032; &#45936;&#51060;&#53552;&#49483; &#49373;&#49457; . ì£¼ê°€ ë°ì´í„°ì…‹ ìƒì„± ì ˆì°¨ëŠ” df2list - dictionary - MultiProcessing - MySQL ìˆœì„œë¡œ ì§„í–‰í•œë‹¤. 4ê°€ì§€ ì ˆì°¨ë¥¼ í†µí•´ ë°ì´í„°ì…‹ì´ ë‹¬ë¼ì§€ëŠ” ê²ƒì€ ì•„ë‹ˆê³ , ì†ë„ë¥¼ ê°œì„ ì‹œí‚¤ëŠ” ë°©í–¥ìœ¼ë¡œì˜ íš¨ìœ¨ì ì¸ ì½”ë“œë¥¼ ì§œê¸° ìœ„í•œ í›ˆë ¨ ê³¼ì •ì´ë‹¤. ëŒ€ê·œëª¨ ë°ì´í„°ì…‹ì„ ë‹¤ë£¨ê¸° ìœ„í•´ì„œëŠ” íš¨ìœ¨ì ì¸ ì½”ë”©ì„ í†µí•´ ì†ë„ë¥¼ ê°œì„ í•˜ëŠ” ê²ƒë„ ì¤‘ìš”í•œ ì¼ì´ë‹¤. íŠ¹íˆ ì´ë²ˆì— ì‚¬ìš©í•˜ëŠ” ì£¼ê°€ ë°ì´í„°ì…‹ì€ ì–‘ì´ ë§ì„ ë¿ë§Œ ì•„ë‹ˆë¼, fdr ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì‚¬ìš©í•˜ì—¬ ì™¸ë¶€ì—ì„œ ë¶ˆëŸ¬ì™€ì•¼í•˜ê¸° ë•Œë¬¸ì— ë°ì´í„°ì…‹ì„ êµ¬ì„±í•˜ëŠ” ê²ƒë§Œ í•´ë„ ì†ë„ê°€ ìƒë‹¹íˆ ëŠë¦¬ë‹¤. ì´ëŸ¬í•œ ë¬¸ì œì ì„ í•´ê²°í•˜ê³ ì ë³¸ í¬ìŠ¤íŒ…ì—ì„œëŠ” 4ë‹¨ê³„ì— ê±¸ì¹œ ë°ì´í„°ì…‹ ìƒì„± ê³¼ì •ì„ ë³´ì—¬ì¤€ë‹¤. . . &#45936;&#51060;&#53552;&#49483; &#51221;&#51032; . ì¡°ê±´: ì „ì²´ ì•½ 2000ê°œ ì¢…ëª© ì¤‘ 2018ë…„ ë¶€í„° ì¡´ì†í•˜ì˜€ë˜ ê¸°ì—… ì¤‘ ê±°ë˜ëŒ€ê¸ˆì´ 1000ì–µ ì´ìƒ ë°œìƒí•œ ë‚ ì§œ (ê±°ë˜ëŒ€ê¸ˆì€ ì¶”í›„ì— ìˆ˜ì • ê°€ëŠ¥) | column: ì¡°ê±´ ì—ì„œ ì„ ë³„í•œ íŠ¹ì • ë‚ ì§œë¥¼ D0ë¼ê³  í–ˆì„ ë•Œ, D-9, D-8, ..., D0, ì´ 10ì¼ ì¹˜ì˜ Open, High, Low, Close, ê±°ë˜ëŒ€ê¸ˆ(trading_value) | label: ì¡°ê±´ì— ë¶€í•©í•˜ëŠ” íŠ¹ì • ë‚ ì§œ(D0) ëŒ€ë¹„ ë‹¤ìŒë‚ (D+1) ë‚ ì§œì˜ ì¢…ê°€(close)ê°€ 2%ì´ìƒ ìƒìŠ¹í•˜ë©´ 1, ìƒìŠ¹í•˜ì§€ ì•Šìœ¼ë©´ 0 | train dataset: 2018ë…„ 1ì›” 2ì¼ - 2020ë…„ 12ì›” 31ì¼ (2ë…„) | test dataset: 2021ë…„ 1ì›” 2ì¼ ~ 2021ë…„ 6ì›” 31ì¼ (6ê°œì›”) | . . &#45936;&#51060;&#53552;&#49483; &#49373;&#49457; &#44284;&#51228; . ë°ì´í„°ì…‹ ìƒì„±ì„ ì´ 3ê°€ì§€ ê³¼ì œë¡œ ë‚˜ëˆ„ì–´ ì§„í–‰í•œë‹¤. . ê³¼ì œ I: ì¢…ëª© ë¦¬ìŠ¤íŠ¸ ìƒì„±-2018ë…„ ë¶€í„° ì¡´ì†í•˜ì˜€ë˜ ê¸°ì—…(ìƒì¥ì¼ 2018ë…„ 1ì›” 1ì¼ ì´ì „ ê¸°ì—…) ì„ ë³„ | ê³¼ì œ II: ê³¼ì œI ì˜ ê¸°ì—… ì¤‘ ê±°ë˜ëŒ€ê¸ˆì´ 1000ì–µ ì´ìƒ ë°œìƒí–ˆë˜ íŠ¹ì • ë‚ ì§œ ì„ ë³„ (ê±°ë˜ëŒ€ê¸ˆ=ê±°ë˜ëŸ‰Xì¢…ê°€ ë¡œ ê³„ì‚°) | ê³¼ì œ III: ê³¼ì œII ì˜ ë‚ ì§œì— ëŒ€í•´ ìµœì¢… ë¨¸ì‹ ëŸ¬ë‹ ë°ì´í„° ìƒì„± | . . &#47785;&#52264; . (0) Finance Data Readerë¥¼ ì´ìš©í•œ ì£¼ê°€ ë°ì´í„°ì…‹ - DataFrame | (1) Finance Data Readerë¥¼ ì´ìš©í•œ ì£¼ê°€ ë°ì´í„°ì…‹ - df2list | (2) Finance Data Readerë¥¼ ì´ìš©í•œ ì£¼ê°€ ë°ì´í„°ì…‹ - dictionary | (3) Finance Data Readerë¥¼ ì´ìš©í•œ ì£¼ê°€ ë°ì´í„°ì…‹ - MultiProcessing | (4) Finance Data Readerë¥¼ ì´ìš©í•œ ì£¼ê°€ ë°ì´í„°ì…‹ - MySQL | (5) ìµœì¢… ë¨¸ì‹ ëŸ¬ë‹ ë°ì´í„°ì…‹ | . &#54596;&#50836; &#46972;&#51060;&#48652;&#47084;&#47532; import . # ! pip install -U finance-datareader . import pandas as pd import os from tqdm import tqdm import FinanceDataReader as fdr import time # ê²½ê³  ë©”ì‹œì§€ ë¬´ì‹œ import warnings warnings.filterwarnings(action=&#39;ignore&#39;) . &#10004;&#65039; (0) Finance Data Reader&#47484; &#51060;&#50857;&#54620; &#51452;&#44032; &#45936;&#51060;&#53552;&#49483; - DataFrame . ì†ë„ ë¹„êµë¥¼ ìœ„í•´ ê¸°ì¡´ ë°ì´í„°ì˜ íƒ€ì…ì¸ DataFrameì„ ì‚¬ìš©í•˜ì—¬ ë°ì´í„°ì…‹ì„ ìƒì„±í•œë‹¤. ì—°êµ¬ ì¸í„´ ì´ˆê¸° ì²«ë²ˆì§¸ë¡œ ì‘ì„±í–ˆë˜ ì½”ë“œë“¤ì¸ë°, ê°œì„ í•´ì•¼ í•  ë¶€ë¶„ë“¤ì´ ë§ë‹¤. . ê³¼ì œ I . df = pd.read_html(&#39;http://kind.krx.co.kr/corpgeneral/corpList.do?method=download&#39;, header=0)[0] # íšŒì‚¬ëª…, ì¢…ëª©ì½”ë“œ, ìƒì¥ì¼ ì»¬ëŸ¼ë§Œ ì‚¬ìš© df_code = df[[&#39;íšŒì‚¬ëª…&#39;, &#39;ì¢…ëª©ì½”ë“œ&#39;, &#39;ìƒì¥ì¼&#39;]] # ì¢…ëª©ì½”ë“œë¥¼ 6ìë¦¬ë¡œ ë§ì¶° ì¤€ë‹¤. df_code[&#39;ì¢…ëª©ì½”ë“œ&#39;] = df_code[&#39;ì¢…ëª©ì½”ë“œ&#39;].apply(lambda x : str(x).zfill(6)) display(df_code.head(3)) print() # ìƒì¥ì¼ì´ 2018ë…„ 1ì›” 1ì¼ ì´ì „ì¸ ì¢…ëª©ì½”ë“œ ì„ ë³„ start_time = time.time() lst_code = df_code.loc[df_code[&#39;ìƒì¥ì¼&#39;] &lt; &#39;2018-01-01&#39;, &#39;ì¢…ëª©ì½”ë“œ&#39;].to_list() print(&quot;ê±¸ë¦° ì‹œê°„: &quot;, time.time() - start_time) print() print(&#39;ìƒì¥ì¼ 2018-01-01 ì´ì „ ì¢…ëª©ì½”ë“œ: &#39;, lst_code[:5]) print() print(f&#39;ì´ {len(df_code)} ê°œì˜ ì¢…ëª© ì¤‘ {len(lst_code)} ê°œì˜ ì¢…ëª© ì„ ë³„&#39;) . íšŒì‚¬ëª… ì¢…ëª©ì½”ë“œ ìƒì¥ì¼ . 0 DL | 000210 | 1976-02-02 | . 1 DRBë™ì¼ | 004840 | 1976-05-21 | . 2 DSR | 155660 | 2013-05-15 | . ê±¸ë¦° ì‹œê°„: 0.0006933212280273438 ìƒì¥ì¼ 2018-01-01 ì´ì „ ì¢…ëª©ì½”ë“œ: [&#39;000210&#39;, &#39;004840&#39;, &#39;155660&#39;, &#39;078930&#39;, &#39;001390&#39;] ì´ 2507 ê°œì˜ ì¢…ëª© ì¤‘ 1977 ê°œì˜ ì¢…ëª© ì„ ë³„ . ê³¼ì œ II . stock_dict = {} for code in tqdm(lst_code): stock = fdr.DataReader(code, start=&#39;20180101&#39;, end=&#39;20201231&#39;) stock[&#39;trading&#39;] = stock[&#39;Volume&#39;] * stock[&#39;Close&#39;] # ê±°ë˜ëŒ€ê¸ˆ ì»¬ëŸ¼ ì¶”ê°€ if sum(stock[&#39;trading&#39;] &gt;= 100000000000) &gt;= 1: # ê±°ë˜ëŒ€ê¸ˆì´ 1000ì–µ ì´ìƒì¸ ë°ì´í„°ê°€ í•˜ë‚˜ ì´ìƒ ì¡´ì¬í•˜ë©´ stock_dict[code] = stock[stock[&#39;trading&#39;] &gt;= 100000000000].index print(f&#39;ì´ {len(lst_code)} ê°œì˜ ì¢…ëª© ì¤‘ {len(stock_dict)} ê°œì˜ ì¢…ëª© ì‚¬ìš©&#39;) . 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1977/1977 [02:58&lt;00:00, 11.08it/s] . ì´ 1977 ê°œì˜ ì¢…ëª© ì¤‘ 799 ê°œì˜ ì¢…ëª© ì‚¬ìš© . . lst_code_date = [] for code in tqdm(stock_dict): for date in (stock_dict[code]): lst_code_date.append([code, date]) print(f&#39;ì„ ë³„ëœ ë‚ ì§œëŠ” ì´ {len(lst_code_date)}ê°œ&#39;) . 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 799/799 [00:00&lt;00:00, 13125.89it/s] . ì„ ë³„ëœ ë‚ ì§œëŠ” ì´ 14182ê°œ . . ê³¼ì œ III . data_dict = {&#39;code&#39;: [], &#39;d0&#39;: [], &#39;info&#39;: [], &#39;up&#39;: []} for code, date in tqdm(lst_code_date): start_date = &#39;20171201&#39; # 2018ë…„ ì´ˆë°˜ ë‚ ì§œê°€ D0ë¼ë©´ 2017ë…„ ë°ì´í„° í•„ìš” (D-9~D-1) end_date = &#39;20210130&#39; # 2020ë…„ í›„ë°˜ ë‚ ì§œê°€ D0ë¼ë©´ 2021ë…„ ë°ì´í„° í•„ìš” (D+1) stock = fdr.DataReader(code, start = start_date, end = end_date) stock.reset_index(inplace=True) # &#39;Date&#39; index -&gt; column D9_index = stock[stock[&#39;Date&#39;] == str(date)].index[0] - 9 # D-9 ë‚ ì§œì˜ ì¸ë±ìŠ¤ next_index = stock[stock[&#39;Date&#39;] == str(date)].index[0] + 1 # D+1 ë‚ ì§œì˜ ì¸ë±ìŠ¤ # ì¢…ëª©ì½”ë“œ (code) data_dict[&#39;code&#39;].append(code) # ê¸°ì¤€ì¼ (d0) data_dict[&#39;d0&#39;].append(date) # D-9 ~ D+1, ì´ 11ì¼ì¹˜ì˜ sub stock DataFrame ìƒì„± sub_stock = stock.iloc[D9_index:next_index+1] sub_stock[&#39;trading&#39;] = sub_stock[&#39;Close&#39;] * sub_stock[&#39;Volume&#39;] # ê±°ë˜ëŒ€ê¸ˆ ì»¬ëŸ¼ ì¶”ê°€ # 10ì¼ ê°„ì˜ ë°ì´í„° (info) info_list = [] for i in range(10): info_list.append(sub_stock.iloc[i, [1, 2, 3, 4, -1]].to_list()) remove_list=[&#39;[&#39;, &#39;]&#39;] for i in range(2): info_list = f&#39;{info_list}&#39;.replace(remove_list[i], &#39;&#39;) data_dict[&#39;info&#39;].append(info_list) # D+1 ì¢…ê°€ 2% ìƒìŠ¹ ì—¬ë¶€ (up) up = sub_stock.iloc[-2][&#39;Close&#39;] + 0.02 * sub_stock.iloc[-2][&#39;Close&#39;] if sub_stock.iloc[-1][&#39;Close&#39;] &gt;= up: data_dict[&#39;up&#39;].append(1) else: data_dict[&#39;up&#39;].append(0) . 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 14182/14182 [17:08&lt;00:00, 13.78it/s] . df_result = pd.DataFrame(data_dict) display(df_result.head()) # ìµœì¢… ê²°ê³¼ ë°ì´í„°ì…‹ txt íŒŒì¼ ì €ì¥ df_result.to_csv(&quot;assignment3.txt&quot;) print(f&#39;ìƒì„±ëœ ë°ì´í„°ì˜ ê°œìˆ˜ëŠ” {len(pd.read_csv(&quot;assignment3.txt&quot;))} ê°œ&#39;) . code d0 info up . 0 000210 | 2018-01-26 | 78343, 78614, 76987, 77892, 9590608284, 77801,... | 0 | . 1 000210 | 2018-08-08 | 68855, 69397, 67590, 69036, 6067435968, 69487,... | 0 | . 2 000210 | 2020-04-02 | 44819, 52951, 44322, 51145, 15615437965, 47439... | 0 | . 3 000210 | 2020-09-11 | 80783, 84487, 78524, 78524, 61554885076, 79608... | 0 | . 4 000210 | 2020-12-11 | 76174, 76174, 72289, 72289, 76043112348, 72831... | 0 | . ìƒì„±ëœ ë°ì´í„°ì˜ ê°œìˆ˜ëŠ” 14182 ê°œ . ê°œì„ í•´ì•¼í•  ì‚¬í•­ . ì†ë„ ê°œì„ : ê³¼ì œIII ì€ ì•½ 17ë¶„ì´ ê±¸ë¦° ê²ƒì„ ë³´ì•„ ì†ë„ ë©´ì—ì„œ ìƒë‹¹íˆ ë¹„íš¨ìœ¨ì ì´ì—ˆë‹¤ëŠ” ê²ƒì„ ì•Œ ìˆ˜ ìˆë‹¤. (ê±°ë˜ëŒ€ê¸ˆì„ 10ì–µìœ¼ë¡œ ì„¤ì •í–ˆì„ ë•Œ 1% ì§„í–‰ì— 5ë¶„ì´ ê±¸ë ¸ë‹¤. ê·¸ëŸ¼ ì´ 500ë¶„ì´ ê±¸ë¦´ ê²ƒìœ¼ë¡œ ì˜ˆìƒí•  ìˆ˜ ìˆë‹¤.) | . # 10ì¼ ê°„ì˜ ë°ì´í„° ë¶€ë¶„: info_listì— ë°ì´í„°ë¥¼ ì¶”ê°€í•˜ëŠ” ê³¼ì •ì—ì„œ ì–µì§€ë¡œ í¬ë§·ì„ ë§ì¶”ê¸° ìœ„í•´ ë¶ˆí•„ìš”í•œ forë¬¸ì´ ë“¤ì–´ê°”ë‹¤. | . # D+1 ì¢…ê°€ 2% ìƒìŠ¹ ì—¬ë¶€ ë¶€ë¶„: ì „ ë‚  ëŒ€ë¹„ 2% ìƒìŠ¹ìœ¨ì„ ì§ì ‘ ê³„ì‚°í•´ ì£¼ì—ˆëŠ”ë°, ì´ë¯¸ ë³€í™”ìœ¨ì´ ê³„ì‚° ë˜ì–´ ìˆëŠ” changeë¼ëŠ” ì»¬ëŸ¼ì„ ì‚¬ìš©í•˜ëŠ” ê²ƒìœ¼ë¡œ ëŒ€ì²´í•œë‹¤. | . txt íŒŒì¼ ì €ì¥: DataFrameìœ¼ë¡œ ìƒì„±ì„ í•œ í›„ì— txt íŒŒì¼ë¡œ ì €ì¥í–ˆëŠ”ë°, ë°ì´í„° ìƒì„± ì‹œ íŒŒì¼ ì…ì¶œë ¥ write()ë¥¼ ì‚¬ìš©í•´ì„œ ë°”ë¡œ txt íŒŒì¼ë¡œ ì €ì¥í•˜ëŠ” ë°©ì‹ìœ¼ë¡œ ë³€ê²½í•œë‹¤. | . . &#10004;&#65039; (1) Finance Data Reader&#47484; &#51060;&#50857;&#54620; &#51452;&#44032; &#45936;&#51060;&#53552;&#49483; - df2list . ì²«ë²ˆì§¸ ë°©ë²•ì€ DataFrame ì‚¬ìš©ì„ ì§€ì–‘í•˜ê³ , pythonì˜ ê¸°ë³¸ ë°ì´í„° íƒ€ì…ì¸ listë¡œ ë°”ê¾¸ì–´ ì‚¬ìš©í•˜ëŠ” ë°©ë²•ì´ë‹¤. ì´ë¡œì¨ column ì¤‘ì‹¬ì˜ ì—°ì‚°ì„ row ì¤‘ì‹¬ì˜ ì—°ì‚°ìœ¼ë¡œ ë°”ê¾¸ì–´ì¤€ë‹¤. ì´ ë°©ë²•ì—ì„œëŠ” ì†ë„ ê°œì„  ë³´ë‹¤ëŠ” (0)ë²ˆ ë°©ë²•ì˜ ì½”ë“œì—ì„œ íš¨ìœ¨ì ì´ì§€ ëª»í–ˆë˜ ë¶€ë¶„ì„ ê³ ì¹˜ê³  ê¹”ë”í•œ ì½”ë“œë¡œ ë³´ì™„í•œë‹¤. . ê³¼ì œ I . display(df_code.head(2)) # ğŸŒŸ dataframe -&gt; list lst_stock = df_code.values.tolist() print(lst_stock[:2]) print() lst_code = [] # ì„ ë³„ ëœ ì½”ë“œë¥¼ ë‹´ì„ ë¦¬ìŠ¤íŠ¸ start_time = time.time() for row in lst_stock: code, date = row[1], row[2] if date &lt;= &#39;2018-01-01&#39;: lst_code.append(code) print(&quot;ê±¸ë¦° ì‹œê°„: &quot;, time.time() - start_time) print() print(&#39;ìƒì¥ì¼ 2018-01-01 ì´ì „ ì¢…ëª©ì½”ë“œ: &#39;, lst_code[:4]) print() print(f&#39;ì´ {len(df_code)} ê°œì˜ ì¢…ëª© ì¤‘ {len(lst_code)} ê°œì˜ ì¢…ëª© ì„ ë³„&#39;) . íšŒì‚¬ëª… ì¢…ëª©ì½”ë“œ ìƒì¥ì¼ . 0 DL | 000210 | 1976-02-02 | . 1 DRBë™ì¼ | 004840 | 1976-05-21 | . [[&#39;DL&#39;, &#39;000210&#39;, &#39;1976-02-02&#39;], [&#39;DRBë™ì¼&#39;, &#39;004840&#39;, &#39;1976-05-21&#39;]] ê±¸ë¦° ì‹œê°„: 0.0004284381866455078 ìƒì¥ì¼ 2018-01-01 ì´ì „ ì¢…ëª©ì½”ë“œ: [&#39;000210&#39;, &#39;004840&#39;, &#39;155660&#39;, &#39;078930&#39;] ì´ 2507 ê°œì˜ ì¢…ëª© ì¤‘ 1977 ê°œì˜ ì¢…ëª© ì„ ë³„ . ê³¼ì œ II . lst_code_date = [] for code in tqdm(lst_code): stock = fdr.DataReader(code, start=&#39;20180102&#39;, end=&#39;20201231&#39;) stock.reset_index(inplace=True) # ğŸŒŸ dataframe -&gt; list lst_stock = stock.values.tolist() for row in lst_stock: date, trading_value = row[0], row[4]*row[5] if trading_value &gt;= 100000000000: # ê±°ë˜ëŒ€ê¸ˆ 1000ì–µ ì´ìƒ lst_code_date.append([code, date.date().strftime(&quot;%Y%m%d&quot;)]) print(f&#39;ì„ ë³„ëœ ë‚ ì§œëŠ” ì´ {len(lst_code_date)}ê°œ&#39;) . 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1977/1977 [02:55&lt;00:00, 11.26it/s] . ì„ ë³„ëœ ë‚ ì§œëŠ” ì´ 14182ê°œ . . ê³¼ì œ III . OF = open(&#39;assignment3.txt&#39;,&#39;w&#39;) for code, date in tqdm(lst_code_date): start_date = &#39;20180101&#39; end_date = &#39;20201231&#39; stock = fdr.DataReader(code, start = start_date, end = end_date) stock.reset_index(inplace=True) # &#39;Date&#39; index -&gt; column # ğŸŒŸ dataframe -&gt; list lst_stock = stock.values.tolist() for idx, row in enumerate(lst_stock): if (idx &lt; 9) or (idx &gt;= len(lst_stock)-1): # ì˜ˆì™¸ ì²˜ë¦¬ continue if row[0].date().strftime(&quot;%Y%m%d&quot;) == date: # D-9 ~ D0 ë°ì´í„°ë§Œ ë‹´ê¸° sub_stock = lst_stock[idx-9:idx+1] # 10ì¼ ê°„ì˜ ë°ì´í„° lst_info = [] for row2 in sub_stock: lst_prices, trading_value = row2[1:5], row[4]*row[5] lst_info += lst_prices + [trading_value] info = &#39;,&#39;.join(map(str, lst_info)) # D+1 ì¢…ê°€ 2% ìƒìŠ¹ ì—¬ë¶€ (up) change = lst_stock[idx+1][6] label = int(change &gt;= 0.02) # ì €ì¥ OF.write(f&#39;{code} t{date} t{lst_info} t{label} n&#39;) OF.close() print(f&#39;ìƒì„±ëœ ë°ì´í„°ì˜ ê°œìˆ˜ëŠ” {len(pd.read_csv(&quot;assignment3.txt&quot;))} ê°œ&#39;) . 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 14182/14182 [17:43&lt;00:00, 13.33it/s] . ìƒì„±ëœ ë°ì´í„°ì˜ ê°œìˆ˜ëŠ” 13939 ê°œ . . OF.write()ë¥¼ ì‚¬ìš©í•¨ìœ¼ë¡œì¨ ë¸”í•„ìš”í•œ DataFrame ì„ ìƒì„±í•˜ì§€ ì•ŠëŠ”ë‹¤. | . # 10ì¼ê°„ì˜ ë°ì´í„° ë¶€ë¶„ì€ join() í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ì—¬ ë¶ˆí•„ìš”í•œ forë¬¸ ì‚¬ìš©ì„ ì¤„ì˜€ê³ , # D+1 ì¢…ê°€ 2% ìƒìŠ¹ ì—¬ë¶€ (up) ë¶€ë¶„ì€ ì „ë‚  ëŒ€ë¹„ ì¢…ê°€ ë³€í™”ìœ¨ì„ ê³„ì‚°í•˜ì§€ ì•Šê³  change ì»¬ëŸ¼ì„ í™œìš©í•˜ëŠ” ê²ƒìœ¼ë¡œ ë°”ê¾¸ì—ˆë‹¤. | . ì†ë„ì— ëŒ€í•œ ë¬¸ì œì  : ì „ ë³´ë‹¤ ê¹”ë”í•œ ì½”ë“œë¡œ ë³´ì™„ì´ ë˜ì—ˆì§€ë§Œ, ì•„ì§ ì†ë„ì— ëŒ€í•œ ë¬¸ì œì ì´ ë‚¨ì•„ìˆë‹¤. ì†ë„ë¥¼ ê°œì„ í•˜ê¸° ìœ„í•´ì„œëŠ” fdr ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ìµœì†Œí•œìœ¼ë¡œ ì‚¬ìš©í•´ì•¼ í•œë‹¤. ì´ë¥¼ í•´ê²°í•˜ê¸° ìœ„í•´ dictionaryë¥¼ ì‚¬ìš©í•˜ëŠ” ë°©ë²•ìœ¼ë¡œ ë„˜ì–´ê°„ë‹¤. | . . &#10004;&#65039; (2) Finance Data Reader&#47484; &#51060;&#50857;&#54620; &#51452;&#44032; &#45936;&#51060;&#53552;&#49483; - dictionary . dictionaryë¥¼ ì‚¬ìš©í•˜ëŠ” ë°©ë²•ì€ ê³¼ì œIII ì˜ ì†ë„ë¥¼ ê°œì„ í•œë‹¤. fdr ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ìµœì†Œí•œìœ¼ë¡œ ì‚¬ìš©í•˜ê³ , forë¬¸ì„ ìµœëŒ€í•œ ì¤„ì¸ë‹¤. í˜„ì¬ ë¬¸ì œì ì€ ë‚ ì§œë¥¼ ê¸°ì¤€ìœ¼ë¡œ forë¬¸ì´ ëŒì•„ê°€ê¸° ë•Œë¬¸ì— ê°™ì€ ë°ì´í„°(ê°™ì€ ì¢…ëª©)ê°€ ì—¬ëŸ¬ë²ˆ ë¶ˆëŸ¬ì™€ì§€ëŠ” ê²½ìš°ê°€ ë‹¤ìˆ˜ ì¡´ì¬í•œë‹¤ëŠ” ê²ƒì´ë‹¤. ë”°ë¼ì„œ ê³¼ì œII ì—ì„œ codeë³„ D0 ë‚ ì§œ ë¦¬ìŠ¤íŠ¸ë¥¼ dictionary íƒ€ì…ìœ¼ë¡œ ìƒì„±í•˜ê³ , ê³¼ì œIII ì—ì„œ code ë‹¹ í•œë²ˆë§Œ fdr ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì‚¬ìš©í•˜ë„ë¡ ë°”ê¾¸ì–´ ì¤€ë‹¤. . ê³¼ì œ I . ê³¼ì œI ì€ ì•ì˜ ë°©ë²•ê³¼ ê°™ìœ¼ë¯€ë¡œ ìƒëµí•œë‹¤. . print(&#39;ìƒì¥ì¼ 2018-01-01 ì´ì „ ì¢…ëª©ì½”ë“œ: &#39;, lst_code[:4]) print() print(f&#39;ì´ {len(df_code)} ê°œì˜ ì¢…ëª© ì¤‘ {len(lst_code)} ê°œì˜ ì¢…ëª© ì„ ë³„&#39;) . ìƒì¥ì¼ 2018-01-01 ì´ì „ ì¢…ëª©ì½”ë“œ: [&#39;000210&#39;, &#39;004840&#39;, &#39;155660&#39;, &#39;078930&#39;] ì´ 2507 ê°œì˜ ì¢…ëª© ì¤‘ 1977 ê°œì˜ ì¢…ëª© ì„ ë³„ . ê³¼ì œ II . dict_code2date = {} for code in tqdm(lst_code): start_date = &#39;20180102&#39; end_date = &#39;20201231&#39; stock = fdr.DataReader(code, start = start_date, end = end_date) stock.reset_index(inplace=True) # ğŸŒŸ dataframe -&gt; list lst_stock = stock.values.tolist() for row in lst_stock: date, trading_value = row[0], row[4]*row[5] if trading_value &gt;= 100000000000: if code not in dict_code2date.keys(): dict_code2date[code] = [date.date().strftime(&quot;%Y%m%d&quot;)] else: dict_code2date[code].append(date.date().strftime(&quot;%Y%m%d&quot;)) print(f&#39;ì´ {len(lst_code)} ê°œì˜ ì¢…ëª© ì¤‘ {len(dict_code2date)} ê°œì˜ ì¢…ëª© ì‚¬ìš©&#39;) . 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1977/1977 [02:42&lt;00:00, 12.14it/s] . ì´ 1977 ê°œì˜ ì¢…ëª© ì¤‘ 799 ê°œì˜ ì¢…ëª© ì‚¬ìš© . . ê³¼ì œ III . OF = open(&#39;assignment3.txt&#39;, &#39;w&#39;) for code in tqdm(dict_code2date): # codeì˜ stock start_date = &#39;20180101&#39; end_date = &#39;20201231&#39; stock = fdr.DataReader(code, start = start_date, end = end_date) stock.reset_index(inplace=True) # ğŸŒŸ dataframe -&gt; list lst_stock = stock.values.tolist() for idx, row in enumerate(lst_stock): if (idx &lt; 9) or (idx &gt;= len(lst_stock)-1): # ì˜ˆì™¸ ì²˜ë¦¬ continue date = row[0].date().strftime(&quot;%Y%m%d&quot;) if date not in dict_code2date[code]: # ì¡°ê±´ì— ë¶€í•©í•˜ëŠ” ë‚ ì§œ (D0 ë‚ ì§œ)ë¥¼ ë°œê²¬í•  ë•Œê¹Œì§€ continue continue # D-9 ~ D0 ë°ì´í„°ë§Œ ë‹´ê¸° sub_stock = lst_stock[idx-9:idx+1] # 10ì¼ê°„ì˜ ë°ì´í„° lst_info = [] for row2 in sub_stock: lst_prices, trading_value = row2[1:5], row2[4]*row2[5] lst_info += lst_prices + [trading_value] info = &#39;,&#39;.join(map(str, lst_info)) # D+1 ì¢…ê°€ 2% ìƒìŠ¹ ì—¬ë¶€ label = int(lst_stock[idx+1][6] &gt;= 0.02) # ì €ì¥ OF.write(f&#39;{code} t{date} t{info} t{label} n&#39;) OF.close() print(f&#39;ìƒì„±ëœ ë°ì´í„°ì˜ ê°œìˆ˜ëŠ” {len(pd.read_csv(&quot;assignment3.txt&quot;))} ê°œ&#39;) . 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 799/799 [01:07&lt;00:00, 11.84it/s] . ìƒì„±ëœ ë°ì´í„°ì˜ ê°œìˆ˜ëŠ” 13939 ê°œ . . ì•½ 17ë¶„ì´ ê±¸ë¦¬ë˜ ì‹œê°„ì´ 1ë¶„ìœ¼ë¡œ ì¤„ì–´ë“¤ì—ˆë‹¤. . . &#10004;&#65039; (3) Finance Data Reader&#47484; &#51060;&#50857;&#54620; &#51452;&#44032; &#45936;&#51060;&#53552;&#49483; - MultiProcessing . multi processing(ë‹¤ì¤‘ ì²˜ë¦¬): ì»´í“¨í„° ì‹œìŠ¤í…œ í•œ ëŒ€ì— ë‘ê°œ ì´ìƒì˜ ì¤‘ì•™ ì²˜ë¦¬ ì¥ì¹˜ (CPU) ë¥¼ ì´ìš©í•˜ì—¬ ë³‘ë ¬ì²˜ë¦¬í•˜ëŠ” ê²ƒ | . python multi processing ë¬¸ì„œ: https://docs.python.org/ko/3/library/multiprocessing.html. | . pythonì€ multiprocessing ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ í†µí•´ ë‹¤ì¤‘ ì²˜ë¦¬ë¥¼ ì§€ì›í•œë‹¤. ì—¬ëŸ¬ ê°œì˜ ì½”ì–´ë¥¼ ì—°ì‚°ì— ì‚¬ìš©í•¨ìœ¼ë¡œì¨ ë§ì€ ì‘ì—…ì„ ë¹ ë¥¸ ì‹œê°„ì— ì²˜ë¦¬í•´ì¤„ ìˆ˜ ìˆë‹¤ëŠ” ì¥ì ì´ ìˆë‹¤. . [ core=10ìœ¼ë¡œ ì„¤ì •í•˜ì—¬ multi processingì„ ìˆ˜í–‰í•  ë•Œ ì½”ì–´ ì‚¬ìš© ] . import time, os from multiprocessing import Pool . ê³¼ì œ I . ê³¼ì œI ì€ ì•ì˜ ë°©ë²•ê³¼ ê°™ìœ¼ë¯€ë¡œ ìƒëµí•œë‹¤. . print(&#39;ìƒì¥ì¼ 2018-01-01 ì´ì „ ì¢…ëª©ì½”ë“œ: &#39;, lst_code[:4]) print() print(f&#39;ì´ {len(df_code)} ê°œì˜ ì¢…ëª© ì¤‘ {len(lst_code)} ê°œì˜ ì¢…ëª© ì„ ë³„&#39;) . ìƒì¥ì¼ 2018-01-01 ì´ì „ ì¢…ëª©ì½”ë“œ: [&#39;000210&#39;, &#39;004840&#39;, &#39;155660&#39;, &#39;078930&#39;] ì´ 2507 ê°œì˜ ì¢…ëª© ì¤‘ 1977 ê°œì˜ ì¢…ëª© ì„ ë³„ . ê³¼ì œ II . multi processingì„ ìœ„í•œ í•¨ìˆ˜ ì •ì˜ | . def make_lst_result(code): start_date = &#39;20180101&#39; end_date = &#39;20201231&#39; lst_date = [] stock = fdr.DataReader(code, start = start_date, end = end_date) stock.reset_index(inplace=True) # ğŸŒŸ dataframe -&gt; list lst_stock = stock.values.tolist() for row in lst_stock: if row[4] * row[5] &gt;= 100000000000: lst_date.append(row[0].date().strftime(&quot;%Y%m%d&quot;)) return [code, lst_date] . multi processing ìˆ˜í–‰ | . start_time = time.time() num_cores = 10 pool = Pool(num_cores) lst_code_date = pool.map(make_lst_result, lst_code) pool.close() pool.join() print(time.time() - start_time) . 17.97966194152832 . ì•ì„œ ì•½ 2ë¶„ 40ì´ˆ ê°€ ê±¸ë ¸ë˜ ê³¼ì œII ë¥¼ multi processingì„ ì‚¬ìš©í•˜ì—¬ 17ì´ˆëŒ€ë¡œ ë‹¨ì¶•ì‹œì¼°ë‹¤. . dictionary ìƒì„± | . dict_code2date = {} for code, lst_date in tqdm(lst_code_date): if lst_date == []: continue dict_code2date[code] = lst_date print(f&#39;ì´ {len(lst_code)} ê°œì˜ ì¢…ëª© ì¤‘ {len(dict_code2date)} ê°œì˜ ì¢…ëª© ì‚¬ìš©&#39;) . 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1977/1977 [00:00&lt;00:00, 1610124.08it/s] . ì´ 1977 ê°œì˜ ì¢…ëª© ì¤‘ 799 ê°œì˜ ì¢…ëª© ì‚¬ìš© . . ê³¼ì œ III . multi processingì„ ìœ„í•œ í•¨ìˆ˜ ì •ì˜ | . def make_lst_result2(code): # codeì˜ stock start_date = &#39;20180101&#39; end_date = &#39;20201231&#39; stock = fdr.DataReader(code, start = start_date, end = end_date) stock.reset_index(inplace=True) # ğŸŒŸ dataframe -&gt; list lst_stock = stock.values.tolist() lst_result = [] for idx, row in enumerate(lst_stock): if (idx &lt; 9) or (idx &gt;= len(lst_stock)-1): # ì˜ˆì™¸ ì²˜ë¦¬ continue date = row[0].date().strftime(&quot;%Y%m%d&quot;) if date not in dict_code2date[code]: # ì¡°ê±´ì— ë¶€í•©í•˜ëŠ” ë‚ ì§œ (D0 ë‚ ì§œ)ë¥¼ ë°œê²¬í•  ë•Œê¹Œì§€ continue continue # D-9 ~ D0 ë°ì´í„°ë§Œ ë‹´ê¸° sub_stock = lst_stock[idx-9:idx+1] # 10ì¼ê°„ì˜ ë°ì´í„° lst_info = [] for row2 in sub_stock: lst_prices, trading_value = row2[1:5], row2[4]*row2[5] lst_info += lst_prices + [trading_value] info = &#39;,&#39;.join(map(str, lst_info)) # D+1 ì¢…ê°€ 2% ìƒìŠ¹ ì—¬ë¶€ label = int(lst_stock[idx+1][6] &gt;= 0.02) lst_result.append([code, date, info, label]) return lst_result . multi processing ìˆ˜í–‰ | . start_time = time.time() num_cores = 10 pool = Pool(num_cores) lst_data = pool.map(make_lst_result2, dict_code2date.keys()) pool.close() pool.join() print(time.time() - start_time) . 8.186521768569946 . ì•ì„œ ì§„í–‰í–ˆë˜ ë°©ë²•ì—ì„œ 1ë¶„ì´ ê±¸ë ¸ë˜ ì‘ì—…ì´ multi processingì„ í†µí•˜ì—¬ 8ì´ˆë¡œ ì¤„ì–´ë“¤ì—ˆë‹¤. . txt íŒŒì¼ ìƒì„± | . OF = open(&quot;assignment3_multi_processing.txt&quot;, &#39;w&#39;) for row in lst_data: for num in range(len(row)): OF.write(&#39; t&#39;.join(map(str, row[num])) + &#39; n&#39;) OF.close() print(f&#39;ìƒì„±ëœ ë°ì´í„°ì˜ ê°œìˆ˜ëŠ” {len(pd.read_csv(&quot;assignment3_multi_processing.txt&quot;))} ê°œ&#39;) . ìƒì„±ëœ ë°ì´í„°ì˜ ê°œìˆ˜ëŠ” 13939 ê°œ . . &#10004;&#65039; (4) Finance Data Reader&#47484; &#51060;&#50857;&#54620; &#51452;&#44032; &#45936;&#51060;&#53552;&#49483; - MySQL . 4ë²ˆì§¸ ë°©ë²•ì€ MySQLì„ ì‚¬ìš©í•œë‹¤. ì™¸ë¶€ ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ì§€ ì•Šì•„ë„ ë˜ê³ , ì„œë²„ DBì— ì €ì¥ëœ ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ê²ƒì´ë¯€ë¡œ multi processingì„ ì‚¬ìš©í•˜ì§€ ì•Šê³ ë„ ë¹ ë¥¸ ì†ë„ë¡œ ë°ì´í„°ì…‹ì„ ìƒì„±í•  ìˆ˜ ìˆë‹¤. . ê³¼ì œ I . ìµœì¢…ì ìœ¼ë¡œ ë¨¸ì‹ ëŸ¬ë‹ ë¶„ì„ì— ì‚¬ìš©í•  ë°ì´í„°ì…‹ì€ ì½”ìŠ¤í”¼, ì½”ìŠ¤ë‹¥ ì‹œì¥ì— í•´ë‹¹í•˜ëŠ” ì¢…ëª©ë“¤ë§Œì„ ì‚¬ìš©í•œë‹¤. í˜„ì¬ dbì— ì €ì¥ë˜ì–´ ìˆëŠ” ë°ì´í„°ë„ ì½”ìŠ¤í”¼, ì½”ìŠ¤ë‹¥ ì‹œì¥ì— í•´ë‹¹í•˜ëŠ” ì¢…ëª©ë“¤ì´ ì…ë ¥ë˜ì–´ ìˆìœ¼ë©°, í•´ë‹¹ ì¢…ëª©ë“¤ì„ ì¶”ë¦° code_list.txtì—ì„œ ì¢…ëª©ë“¤ì„ ë¶ˆëŸ¬ì™€ lst_codeë¥¼ ì‚¬ìš©í•œë‹¤. . IF = open(&#39;../data/code_list.txt&#39;) lst_code = IF.readlines() print(f&#39;ì´ {len(df_code)} ê°œì˜ ì¢…ëª© ì¤‘ {len(lst_code)} ê°œì˜ ì¢…ëª© ì„ ë³„&#39;) . ì´ 2507 ê°œì˜ ì¢…ëª© ì¤‘ 1561 ê°œì˜ ì¢…ëª© ì„ ë³„ . # ! pip install pymysql import pymysql from sqlalchemy import create_engine . MySQL ë°ì´í„° ì €ì¥ (dataframe -&gt; sql) | . code ë³„ë¡œ ë‹¤ë¥¸ í…Œì´ë¸”ì— ì €ì¥í•œë‹¤. . db_connection_str = &#39;mysql+pymysql://[db username]:[db password]@[host address]/[db name]&#39; db_connection = create_engine(db_connection_str) conn = db_connection.connect() for code in tqdm(lst_code): start_date = &#39;20170101&#39; end_date = &#39;20211231&#39; stock = fdr.DataReader(code, start = start_date, end = end_date) stock = stock.reset_index() stock = stock[[&#39;Date&#39;, &#39;Open&#39;, &#39;High&#39;, &#39;Low&#39;, &#39;Close&#39;, &#39;Volume&#39;, &#39;Change&#39;]] stock.to_sql(name=f&#39;stock_{code}&#39;, con=db_connection, if_exists=&#39;fail&#39;, index=False) . MySQL ì—ì„œ ë°ì´í„° ë¶ˆëŸ¬ì˜¨ í›„ ë°ì´í„°ì…‹ ìƒì„± | . db_dsml = pymysql.connect( host = &#39;localhost&#39;, port = 3306, user = &#39;[db username]&#39;, passwd = &#39;[db password]&#39;, db = &#39;[db name]&#39;, charset = &#39;utf8&#39; ) cursor = db_dsml.cursor() . ê³¼ì œ II . dict_code2date = {} for code in tqdm(lst_code): code = code.strip() sql_query = &#39;&#39;&#39; SELECT * FROM stock_{} WHERE Date BETWEEN &#39;2018-01-01&#39; AND &#39;2020-12-31&#39; &#39;&#39;&#39;.format(code) stock = pd.read_sql(sql = sql_query, con = db_dsml) # ğŸŒŸ dataframe -&gt; list lst_stock = stock.values.tolist() for row in lst_stock: date, trading_value = row[0], row[4]*row[5] if trading_value &gt;= 100000000000: if code not in dict_code2date.keys(): dict_code2date[code] = [date.date().strftime(&quot;%Y%m%d&quot;)] else: dict_code2date[code].append(date.date().strftime(&quot;%Y%m%d&quot;)) print(f&#39;ì´ {len(lst_code)} ê°œì˜ ì¢…ëª© ì¤‘ {len(dict_code2date)} ê°œì˜ ì¢…ëª© ì‚¬ìš©&#39;) . 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1561/1561 [00:22&lt;00:00, 69.07it/s] . ì´ 1561 ê°œì˜ ì¢…ëª© ì¤‘ 679 ê°œì˜ ì¢…ëª© ì‚¬ìš© . . ê³¼ì œ III . OF = open(&#39;assignment3_sql.txt&#39;, &#39;w&#39;) for code in tqdm(dict_code2date): code = code.strip() sql_query = &#39;&#39;&#39; SELECT * FROM stock_{} WHERE Date BETWEEN &#39;2018-01-01&#39; AND &#39;2020-12-31&#39; &#39;&#39;&#39;.format(code) stock = pd.read_sql(sql = sql_query, con = db_dsml) # ğŸŒŸ dataframe -&gt; list lst_stock = stock.values.tolist() for idx, row in enumerate(lst_stock): if (idx &lt; 9) or (idx &gt;= len(lst_stock)-1): # ì˜ˆì™¸ ì²˜ë¦¬ continue date = row[0].date().strftime(&quot;%Y%m%d&quot;) if date not in dict_code2date[code]: # ì¡°ê±´ì— ë¶€í•©í•˜ëŠ” ë‚ ì§œ (D0 ë‚ ì§œ)ë¥¼ ë°œê²¬í•  ë•Œê¹Œì§€ continue continue # D-9 ~ D0 ë°ì´í„°ë§Œ ë‹´ê¸° sub_stock = lst_stock[idx-9:idx+1] # 10ì¼ê°„ì˜ ë°ì´í„° lst_info = [] for row2 in sub_stock: lst_prices, trading_value = row2[1:5], row2[4]*row2[5] lst_info += lst_prices + [trading_value] info = &#39;,&#39;.join(map(str, lst_info)) # D+1 ì¢…ê°€ 2% ìƒìŠ¹ ì—¬ë¶€ label = int(lst_stock[idx+1][6] &gt;= 0.02) # ì €ì¥ OF.write(f&#39;{code} t{date} t{info} t{label} n&#39;) OF.close() print(f&#39;ìƒì„±ëœ ë°ì´í„°ì˜ ê°œìˆ˜ëŠ” {len(pd.read_csv(&quot;assignment3_sql.txt&quot;))} ê°œ&#39;) . 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 679/679 [00:11&lt;00:00, 61.46it/s] . ìƒì„±ëœ ë°ì´í„°ì˜ ê°œìˆ˜ëŠ” 11934 ê°œ . . . &#10004;&#65039; (5) &#52572;&#51333; &#47672;&#49888;&#47084;&#45789; &#45936;&#51060;&#53552;&#49483; . ìµœì¢…ì ìœ¼ë¡œ ìƒì„±ëœ ë¨¸ì‹ ëŸ¬ë‹ ë°ì´í„°ì…‹ì˜ í˜•íƒœë¥¼ í™•ì¸í•œë‹¤. . IF=open(&quot;assignment3_sql.txt&quot;,&#39;r&#39;) lst_code_date=[] trainX=[] trainY=[] for line in IF: code, date, x, y = line.strip().split(&quot; t&quot;) lst_code_date.append([code, date]) trainX.append(list(map(int, x.split(&quot;,&quot;)))) trainY.append(int(y)) trainX=pd.DataFrame(trainX) trainY=pd.DataFrame(trainY) . print(&quot;===== trainX =====&quot;) print(&quot;trainX shape:&quot;, trainX.shape) display(trainX.head()) print() print(&quot;===== trainY =====&quot;) print(&quot;trainY shape:&quot;, trainY.shape) display(trainY.head()) . ===== trainX ===== trainX shape: (11935, 50) . 0 1 2 3 4 5 6 7 8 9 ... 40 41 42 43 44 45 46 47 48 49 . 0 10250 | 12050 | 10150 | 11800 | 307823874200 | 11950 | 12450 | 10900 | 11750 | 240410569500 | ... | 15300 | 15400 | 12650 | 13700 | 789063638200 | 13700 | 16100 | 13400 | 15400 | 897154258000 | . 1 11950 | 12450 | 10900 | 11750 | 240410569500 | 11850 | 14150 | 11600 | 12600 | 764364560400 | ... | 13700 | 16100 | 13400 | 15400 | 897154258000 | 14700 | 15500 | 14000 | 14350 | 277027065700 | . 2 11850 | 14150 | 11600 | 12600 | 764364560400 | 12800 | 13200 | 12000 | 12200 | 170010147600 | ... | 14700 | 15500 | 14000 | 14350 | 277027065700 | 13050 | 13300 | 11650 | 11650 | 231873876050 | . 3 12800 | 13200 | 12000 | 12200 | 170010147600 | 12450 | 13400 | 12350 | 12850 | 211661434950 | ... | 13050 | 13300 | 11650 | 11650 | 231873876050 | 12200 | 13150 | 11600 | 12200 | 222393934200 | . 4 12450 | 13400 | 12350 | 12850 | 211661434950 | 12800 | 12950 | 11300 | 11700 | 91801277100 | ... | 12200 | 13150 | 11600 | 12200 | 222393934200 | 12200 | 13750 | 12100 | 12350 | 256196958550 | . 5 rows Ã— 50 columns . ===== trainY ===== trainY shape: (11935, 1) . 0 . 0 0 | . 1 0 | . 2 1 | . 3 0 | . 4 1 | . kospi + kosdaq ì£¼ì‹ ì‹œì¥, 3ë…„ ì´ìƒ ì¡´ì†í•˜ì˜€ë˜ ì¢…ëª©ë“¤ì„ ê±°ë˜ëŒ€ê¸ˆ 1000ì–µ ì´ìƒì˜ ì¡°ê±´ìœ¼ë¡œ ì„¤ì •í•˜ê³ , 10ì¼ ê°„ì˜ ë°ì´í„°ë“¤ì„ featureë¡œ ë‘ì–´ ìƒì„±í•œ ìµœì¢… ë¨¸ì‹ ëŸ¬ë‹ ë°ì´í„°ì…‹ì€ 11935 X 50 ì˜ í¬ê¸°ê°€ ë‚˜ì™”ë‹¤. | . . 4ë‹¨ê³„ì˜ ê³¼ì •ì„ ê±°ì³ ë¨¸ì‹ ëŸ¬ë‹ ë°ì´í„°ì…‹ ìƒì„±ì„ ë§ˆì³¤ë‹¤. ë‹¤ìŒ ê¸€ì—ì„œëŠ” ìƒì„±ëœ ë¨¸ì‹ ëŸ¬ë‹ ë°ì´í„°ì…‹ì„ ì‚¬ìš©í•˜ì—¬ ì—¬ëŸ¬ ë¨¸ì‹ ëŸ¬ë‹ ëª¨ë¸ì„ í•™ìŠµ ë° í‰ê°€í•˜ì—¬ ì„±ëŠ¥ì´ ê°€ì¥ ì¢‹ì€ ëª¨ë¸ì„ ì„ ì •í•˜ëŠ” baseline model selectionì„ ì§„í–‰í•œë‹¤. .",
            "url": "https://eunsukim06.github.io/blog/stock%20prediction/2022/07/07/stock-dataset.html",
            "relUrl": "/stock%20prediction/2022/07/07/stock-dataset.html",
            "date": " â€¢ Jul 7, 2022"
        }
        
    
  
    
        ,"post1": {
            "title": "Fastpages Notebook Blog Post",
            "content": "About . This notebook is a demonstration of some of capabilities of fastpages with notebooks. . With fastpages you can save your jupyter notebooks into the _notebooks folder at the root of your repository, and they will be automatically be converted to Jekyll compliant blog posts! . Front Matter . The first cell in your Jupyter Notebook or markdown blog post contains front matter. Front matter is metadata that can turn on/off options in your Notebook. It is formatted like this: . # &quot;My Title&quot; &gt; &quot;Awesome summary&quot; - toc:true- branch: master - badges: true - comments: true - author: Hamel Husain &amp; Jeremy Howard - categories: [fastpages, jupyter] . Setting toc: true will automatically generate a table of contents | Setting badges: true will automatically include GitHub and Google Colab links to your notebook. | Setting comments: true will enable commenting on your blog post, powered by utterances. | . The title and description need to be enclosed in double quotes only if they include special characters such as a colon. More details and options for front matter can be viewed on the front matter section of the README. . Markdown Shortcuts . A #hide comment at the top of any code cell will hide both the input and output of that cell in your blog post. . A #hide_input comment at the top of any code cell will only hide the input of that cell. . The comment #hide_input was used to hide the code that produced this. . put a #collapse-hide flag at the top of any cell if you want to hide that cell by default, but give the reader the option to show it: . import pandas as pd import altair as alt . . put a #collapse-show flag at the top of any cell if you want to show that cell by default, but give the reader the option to hide it: . cars = &#39;https://vega.github.io/vega-datasets/data/cars.json&#39; movies = &#39;https://vega.github.io/vega-datasets/data/movies.json&#39; sp500 = &#39;https://vega.github.io/vega-datasets/data/sp500.csv&#39; stocks = &#39;https://vega.github.io/vega-datasets/data/stocks.csv&#39; flights = &#39;https://vega.github.io/vega-datasets/data/flights-5k.json&#39; . . place a #collapse-output flag at the top of any cell if you want to put the output under a collapsable element that is closed by default, but give the reader the option to open it: . print(&#39;The comment #collapse-output was used to collapse the output of this cell by default but you can expand it.&#39;) . The comment #collapse-output was used to collapse the output of this cell by default but you can expand it. . . Interactive Charts With Altair . Charts made with Altair remain interactive. Example charts taken from this repo, specifically this notebook. . Example 1: DropDown . # use specific hard-wired values as the initial selected values selection = alt.selection_single( name=&#39;Select&#39;, fields=[&#39;Major_Genre&#39;, &#39;MPAA_Rating&#39;], init={&#39;Major_Genre&#39;: &#39;Drama&#39;, &#39;MPAA_Rating&#39;: &#39;R&#39;}, bind={&#39;Major_Genre&#39;: alt.binding_select(options=genres), &#39;MPAA_Rating&#39;: alt.binding_radio(options=mpaa)} ) # scatter plot, modify opacity based on selection alt.Chart(df).mark_circle().add_selection( selection ).encode( x=&#39;Rotten_Tomatoes_Rating:Q&#39;, y=&#39;IMDB_Rating:Q&#39;, tooltip=&#39;Title:N&#39;, opacity=alt.condition(selection, alt.value(0.75), alt.value(0.05)) ) . Example 2: Tooltips . alt.Chart(df).mark_circle().add_selection( alt.selection_interval(bind=&#39;scales&#39;, encodings=[&#39;x&#39;]) ).encode( alt.X(&#39;Rotten_Tomatoes_Rating&#39;, type=&#39;quantitative&#39;), alt.Y(&#39;IMDB_Rating&#39;, type=&#39;quantitative&#39;, axis=alt.Axis(minExtent=30)), # y=alt.Y(&#39;IMDB_Rating:Q&#39;, ), # use min extent to stabilize axis title placement tooltip=[&#39;Title:N&#39;, &#39;Release_Date:N&#39;, &#39;IMDB_Rating:Q&#39;, &#39;Rotten_Tomatoes_Rating:Q&#39;] ).properties( width=500, height=400 ) . Example 3: More Tooltips . label = alt.selection_single( encodings=[&#39;x&#39;], # limit selection to x-axis value on=&#39;mouseover&#39;, # select on mouseover events nearest=True, # select data point nearest the cursor empty=&#39;none&#39; # empty selection includes no data points ) # define our base line chart of stock prices base = alt.Chart().mark_line().encode( alt.X(&#39;date:T&#39;), alt.Y(&#39;price:Q&#39;, scale=alt.Scale(type=&#39;log&#39;)), alt.Color(&#39;symbol:N&#39;) ) alt.layer( base, # base line chart # add a rule mark to serve as a guide line alt.Chart().mark_rule(color=&#39;#aaa&#39;).encode( x=&#39;date:T&#39; ).transform_filter(label), # add circle marks for selected time points, hide unselected points base.mark_circle().encode( opacity=alt.condition(label, alt.value(1), alt.value(0)) ).add_selection(label), # add white stroked text to provide a legible background for labels base.mark_text(align=&#39;left&#39;, dx=5, dy=-5, stroke=&#39;white&#39;, strokeWidth=2).encode( text=&#39;price:Q&#39; ).transform_filter(label), # add text labels for stock prices base.mark_text(align=&#39;left&#39;, dx=5, dy=-5).encode( text=&#39;price:Q&#39; ).transform_filter(label), data=stocks ).properties( width=500, height=400 ) . Data Tables . You can display tables per the usual way in your blog: . df[[&#39;Title&#39;, &#39;Worldwide_Gross&#39;, &#39;Production_Budget&#39;, &#39;Distributor&#39;, &#39;MPAA_Rating&#39;, &#39;IMDB_Rating&#39;, &#39;Rotten_Tomatoes_Rating&#39;]].head() . Title Worldwide_Gross Production_Budget Distributor MPAA_Rating IMDB_Rating Rotten_Tomatoes_Rating . 0 The Land Girls | 146083.0 | 8000000.0 | Gramercy | R | 6.1 | NaN | . 1 First Love, Last Rites | 10876.0 | 300000.0 | Strand | R | 6.9 | NaN | . 2 I Married a Strange Person | 203134.0 | 250000.0 | Lionsgate | None | 6.8 | NaN | . 3 Let&#39;s Talk About Sex | 373615.0 | 300000.0 | Fine Line | None | NaN | 13.0 | . 4 Slam | 1087521.0 | 1000000.0 | Trimark | R | 3.4 | 62.0 | . Images . Local Images . You can reference local images and they will be copied and rendered on your blog automatically. You can include these with the following markdown syntax: . ![](my_icons/fastai_logo.png) . . Remote Images . Remote images can be included with the following markdown syntax: . ![](https://image.flaticon.com/icons/svg/36/36686.svg) . . Animated Gifs . Animated Gifs work, too! . ![](https://upload.wikimedia.org/wikipedia/commons/7/71/ChessPawnSpecialMoves.gif) . . Captions . You can include captions with markdown images like this: . ![](https://www.fast.ai/images/fastai_paper/show_batch.png &quot;Credit: https://www.fast.ai/2020/02/13/fastai-A-Layered-API-for-Deep-Learning/&quot;) . . Other Elements . GitHub Flavored Emojis . Typing I give this post two :+1:! will render this: . I give this post two :+1:! . Tweetcards . Typing &gt; twitter: https://twitter.com/jakevdp/status/1204765621767901185?s=20 will render this: Altair 4.0 is released! https://t.co/PCyrIOTcvvTry it with: pip install -U altairThe full list of changes is at https://t.co/roXmzcsT58 ...read on for some highlights. pic.twitter.com/vWJ0ZveKbZ . &mdash; Jake VanderPlas (@jakevdp) December 11, 2019 . Youtube Videos . Typing &gt; youtube: https://youtu.be/XfoYk_Z5AkI will render this: . Boxes / Callouts . Typing &gt; Warning: There will be no second warning! will render this: . Warning: There will be no second warning! . Typing &gt; Important: Pay attention! It&#39;s important. will render this: . Important: Pay attention! It&#8217;s important. . Typing &gt; Tip: This is my tip. will render this: . Tip: This is my tip. . Typing &gt; Note: Take note of this. will render this: . Note: Take note of this. . Typing &gt; Note: A doc link to [an example website: fast.ai](https://www.fast.ai/) should also work fine. will render in the docs: . Note: A doc link to an example website: fast.ai should also work fine. . Footnotes . You can have footnotes in notebooks, however the syntax is different compared to markdown documents. This guide provides more detail about this syntax, which looks like this: . For example, here is a footnote {% fn 1 %}. And another {% fn 2 %} {{ &#39;This is the footnote.&#39; | fndetail: 1 }} {{ &#39;This is the other footnote. You can even have a [link](www.github.com)!&#39; | fndetail: 2 }} . For example, here is a footnote 1. . And another 2 . 1. This is the footnote.â†© . 2. This is the other footnote. You can even have a link!â†© .",
            "url": "https://eunsukim06.github.io/blog/jupyter/2020/02/20/test.html",
            "relUrl": "/jupyter/2020/02/20/test.html",
            "date": " â€¢ Feb 20, 2020"
        }
        
    
  
    
        ,"post2": {
            "title": "An Example Markdown Post",
            "content": "Example Markdown Post . Basic setup . Jekyll requires blog post files to be named according to the following format: . YEAR-MONTH-DAY-filename.md . Where YEAR is a four-digit number, MONTH and DAY are both two-digit numbers, and filename is whatever file name you choose, to remind yourself what this post is about. .md is the file extension for markdown files. . The first line of the file should start with a single hash character, then a space, then your title. This is how you create a â€œlevel 1 headingâ€ in markdown. Then you can create level 2, 3, etc headings as you wish but repeating the hash character, such as you see in the line ## File names above. . Basic formatting . You can use italics, bold, code font text, and create links. Hereâ€™s a footnote 1. Hereâ€™s a horizontal rule: . . Lists . Hereâ€™s a list: . item 1 | item 2 | . And a numbered list: . item 1 | item 2 | Boxes and stuff . This is a quotation . . You can include alert boxes â€¦andâ€¦ . . You can include info boxes Images . . Code . You can format text and code per usual . General preformatted text: . # Do a thing do_thing() . Python code and output: . # Prints &#39;2&#39; print(1+1) . 2 . Formatting text as shell commands: . echo &quot;hello world&quot; ./some_script.sh --option &quot;value&quot; wget https://example.com/cat_photo1.png . Formatting text as YAML: . key: value - another_key: &quot;another value&quot; . Tables . Column 1 Column 2 . A thing | Another thing | . Tweetcards . Altair 4.0 is released! https://t.co/PCyrIOTcvvTry it with: pip install -U altairThe full list of changes is at https://t.co/roXmzcsT58 ...read on for some highlights. pic.twitter.com/vWJ0ZveKbZ . &mdash; Jake VanderPlas (@jakevdp) December 11, 2019 Footnotes . This is the footnote.Â &#8617; . |",
            "url": "https://eunsukim06.github.io/blog/markdown/2020/01/14/test-markdown-post.html",
            "relUrl": "/markdown/2020/01/14/test-markdown-post.html",
            "date": " â€¢ Jan 14, 2020"
        }
        
    
  

  
  

  
      ,"page1": {
          "title": "About Me",
          "content": "This website is powered by fastpages 1. . a blogging platform that natively supports Jupyter notebooks in addition to other formats.Â &#8617; . |",
          "url": "https://eunsukim06.github.io/blog/about/",
          "relUrl": "/about/",
          "date": ""
      }
      
  

  

  
  

  

  
  

  

  
  

  
  

  
  

  
      ,"page10": {
          "title": "",
          "content": "Sitemap: {{ â€œsitemap.xmlâ€ | absolute_url }} | .",
          "url": "https://eunsukim06.github.io/blog/robots.txt",
          "relUrl": "/robots.txt",
          "date": ""
      }
      
  

}