<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="twitter:card" content="summary_large_image" /><!-- Begin Jekyll SEO tag v2.8.0 -->
<title>1-1. ë¨¸ì‹ ëŸ¬ë‹ì„ ìœ„í•œ ì£¼ê°€ ë°ì´í„°ì…‹ ìƒì„± | fastpages</title>
<meta name="generator" content="Jekyll v4.1.1" />
<meta property="og:title" content="1-1. ë¨¸ì‹ ëŸ¬ë‹ì„ ìœ„í•œ ì£¼ê°€ ë°ì´í„°ì…‹ ìƒì„±" />
<meta name="author" content="ag-su" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="2022 DS&amp;ML Stock Prediction Project 1. Stock Prediction Part.1 - baseline model" />
<meta property="og:description" content="2022 DS&amp;ML Stock Prediction Project 1. Stock Prediction Part.1 - baseline model" />
<link rel="canonical" href="https://eunsukim06.github.io/blog/stock%20prediction/2022/07/07/stock-dataset.html" />
<meta property="og:url" content="https://eunsukim06.github.io/blog/stock%20prediction/2022/07/07/stock-dataset.html" />
<meta property="og:site_name" content="fastpages" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2022-07-07T00:00:00-05:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="1-1. ë¨¸ì‹ ëŸ¬ë‹ì„ ìœ„í•œ ì£¼ê°€ ë°ì´í„°ì…‹ ìƒì„±" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"ag-su"},"dateModified":"2022-07-07T00:00:00-05:00","datePublished":"2022-07-07T00:00:00-05:00","description":"2022 DS&amp;ML Stock Prediction Project 1. Stock Prediction Part.1 - baseline model","headline":"1-1. ë¨¸ì‹ ëŸ¬ë‹ì„ ìœ„í•œ ì£¼ê°€ ë°ì´í„°ì…‹ ìƒì„±","mainEntityOfPage":{"@type":"WebPage","@id":"https://eunsukim06.github.io/blog/stock%20prediction/2022/07/07/stock-dataset.html"},"url":"https://eunsukim06.github.io/blog/stock%20prediction/2022/07/07/stock-dataset.html"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/blog/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="https://eunsukim06.github.io/blog/feed.xml" title="fastpages" /><link rel="shortcut icon" type="image/x-icon" href="/blog/images/favicon.ico"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Primer/15.2.0/primer.css" integrity="sha512-xTz2ys4coGAOz8vuV1NcQBkgVmKhsSEtjbqyMJbBHRplFuvKIUo6xhLHpAyPt9mfR6twHJgn9OgVLuqOvjeBhg==" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css" integrity="sha512-1PKOgIY59xJ8Co8+NE6FZ+LOAZKjy+KY8iq0G4B3CyeY6wYHN3yt9PW0XpSriVlkMXe40PTKnXrLnZ9+fkDaog==" crossorigin="anonymous" />

<script>
function wrap_img(fn) {
    if (document.attachEvent ? document.readyState === "complete" : document.readyState !== "loading") {
        var elements = document.querySelectorAll(".post img");
        Array.prototype.forEach.call(elements, function(el, i) {
            if (el.getAttribute("title") && (el.className != "emoji")) {
                const caption = document.createElement('figcaption');
                var node = document.createTextNode(el.getAttribute("title"));
                caption.appendChild(node);
                const wrapper = document.createElement('figure');
                wrapper.className = 'image';
                el.parentNode.insertBefore(wrapper, el);
                el.parentNode.removeChild(el);
                wrapper.appendChild(el);
                wrapper.appendChild(caption);
            }
        });
    } else { document.addEventListener('DOMContentLoaded', fn); }
}
window.onload = wrap_img;
</script>

<script>
    document.addEventListener("DOMContentLoaded", function(){
    // add link icon to anchor tags
    var elem = document.querySelectorAll(".anchor-link")
    elem.forEach(e => (e.innerHTML = '<i class="fas fa-link fa-xs"></i>'));
    });
</script>
</head>
<body><header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" href="/blog/">fastpages</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/blog/about/">About Me</a><a class="page-link" href="/blog/search/">Search</a><a class="page-link" href="/blog/categories/">Tags</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">1-1. ë¨¸ì‹ ëŸ¬ë‹ì„ ìœ„í•œ ì£¼ê°€ ë°ì´í„°ì…‹ ìƒì„±</h1><p class="page-description">2022 DS&ML Stock Prediction Project | 1. Stock Prediction Part.1 - baseline model </p><p class="post-meta post-meta-title"><time class="dt-published" datetime="2022-07-07T00:00:00-05:00" itemprop="datePublished">
        Jul 7, 2022
      </time>â€¢ 
          <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <span class="p-author h-card" itemprop="name">ag-su</span></span>
       â€¢ <span class="read-time" title="Estimated read time">
    
    
      14 min read
    
</span></p>

    
      <p class="category-tags"><i class="fas fa-tags category-tags-icon"></i></i> 
      
        <a class="category-tags-link" href="/blog/categories/#Stock Prediction">Stock Prediction</a>
        
      
      </p>
    

    
      
        <div class="pb-5 d-flex flex-justify-center">
          <div class="px-2">

    <a href="https://github.com/eunsukim06/blog/tree/master/_notebooks/2022-07-07-stock-dataset.ipynb" role="button" target="_blank">
<img class="notebook-badge-image" src="/blog/assets/badges/github.svg" alt="View On GitHub">
    </a>
</div>

          <div class="px-2">
    <a href="https://mybinder.org/v2/gh/eunsukim06/blog/master?filepath=_notebooks%2F2022-07-07-stock-dataset.ipynb" target="_blank">
        <img class="notebook-badge-image" src="/blog/assets/badges/binder.svg" alt="Open In Binder"/>
    </a>
</div>

          <div class="px-2">
    <a href="https://colab.research.google.com/github/eunsukim06/blog/blob/master/_notebooks/2022-07-07-stock-dataset.ipynb" target="_blank">
        <img class="notebook-badge-image" src="/blog/assets/badges/colab.svg" alt="Open In Colab"/>
    </a>
</div>
          <div class="px-2">
  <a href="https://deepnote.com/launch?url=https%3A%2F%2Fgithub.com%2Feunsukim06%2Fblog%2Fblob%2Fmaster%2F_notebooks%2F2022-07-07-stock-dataset.ipynb" target="_blank">
      <img class="notebook-badge-image" src="/blog/assets/badges/deepnote.svg" alt="Launch in Deepnote"/>
  </a>
</div>

        </div>
      </header>

  <div class="post-content e-content" itemprop="articleBody">
    <ul id="toc" class="section-nav">
<li class="toc-entry toc-h1"><a href="#1.-Stock-Prediction-Part.1---baseline-model">1. Stock Prediction Part.1 - baseline model </a>
<ul>
<li class="toc-entry toc-h2"><a href="#1-1.-ë¨¸ì‹ ëŸ¬ë‹ì„-ìœ„í•œ-ì£¼ê°€-ë°ì´í„°ì…‹-ìƒì„±">1-1. ë¨¸ì‹ ëŸ¬ë‹ì„ ìœ„í•œ ì£¼ê°€ ë°ì´í„°ì…‹ ìƒì„± </a>
<ul>
<li class="toc-entry toc-h3"><a href="#ë°ì´í„°ì…‹-ì •ì˜">ë°ì´í„°ì…‹ ì •ì˜ </a></li>
<li class="toc-entry toc-h3"><a href="#ë°ì´í„°ì…‹-ìƒì„±-ê³¼ì œ">ë°ì´í„°ì…‹ ìƒì„± ê³¼ì œ </a></li>
<li class="toc-entry toc-h3"><a href="#ëª©ì°¨">ëª©ì°¨ </a></li>
<li class="toc-entry toc-h3"><a href="#í•„ìš”-ë¼ì´ë¸ŒëŸ¬ë¦¬-import">í•„ìš” ë¼ì´ë¸ŒëŸ¬ë¦¬ import </a></li>
</ul>
</li>
<li class="toc-entry toc-h2"><a href="#âœ”ï¸-(0)-Finance-Data-Readerë¥¼-ì´ìš©í•œ-ì£¼ê°€-ë°ì´í„°ì…‹---DataFrame">âœ”ï¸ (0) Finance Data Readerë¥¼ ì´ìš©í•œ ì£¼ê°€ ë°ì´í„°ì…‹ - DataFrame </a></li>
<li class="toc-entry toc-h2"><a href="#âœ”ï¸-(1)-Finance-Data-Readerë¥¼-ì´ìš©í•œ-ì£¼ê°€-ë°ì´í„°ì…‹---df2list">âœ”ï¸ (1) Finance Data Readerë¥¼ ì´ìš©í•œ ì£¼ê°€ ë°ì´í„°ì…‹ - df2list </a></li>
<li class="toc-entry toc-h2"><a href="#âœ”ï¸-(2)-Finance-Data-Readerë¥¼-ì´ìš©í•œ-ì£¼ê°€-ë°ì´í„°ì…‹---dictionary">âœ”ï¸ (2) Finance Data Readerë¥¼ ì´ìš©í•œ ì£¼ê°€ ë°ì´í„°ì…‹ - dictionary </a></li>
<li class="toc-entry toc-h2"><a href="#âœ”ï¸-(3)-Finance-Data-Readerë¥¼-ì´ìš©í•œ-ì£¼ê°€-ë°ì´í„°ì…‹---MultiProcessing">âœ”ï¸ (3) Finance Data Readerë¥¼ ì´ìš©í•œ ì£¼ê°€ ë°ì´í„°ì…‹ - MultiProcessing </a>
<ul>
<li class="toc-entry toc-h3"><a href="#âœ”ï¸-(4)-Finance-Data-Readerë¥¼-ì´ìš©í•œ-ì£¼ê°€-ë°ì´í„°ì…‹---MySQL">âœ”ï¸ (4) Finance Data Readerë¥¼ ì´ìš©í•œ ì£¼ê°€ ë°ì´í„°ì…‹ - MySQL </a></li>
<li class="toc-entry toc-h3"><a href="#âœ”ï¸-(5)-ìµœì¢…-ë¨¸ì‹ ëŸ¬ë‹-ë°ì´í„°ì…‹">âœ”ï¸ (5) ìµœì¢… ë¨¸ì‹ ëŸ¬ë‹ ë°ì´í„°ì…‹ </a></li>
</ul>
</li>
</ul>
</li>
</ul><!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2022-07-07-stock-dataset.ipynb
-->

<div class="container" id="notebook-container">
        
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="1.-Stock-Prediction-Part.1---baseline-model">
<a class="anchor" href="#1.-Stock-Prediction-Part.1---baseline-model" aria-hidden="true"><span class="octicon octicon-link"></span></a>1. Stock Prediction Part.1 - baseline model<a class="anchor-link" href="#1.-Stock-Prediction-Part.1---baseline-model"> </a>
</h1>
<h2 id="1-1.-ë¨¸ì‹ ëŸ¬ë‹ì„-ìœ„í•œ-ì£¼ê°€-ë°ì´í„°ì…‹-ìƒì„±">
<a class="anchor" href="#1-1.-%EB%A8%B8%EC%8B%A0%EB%9F%AC%EB%8B%9D%EC%9D%84-%EC%9C%84%ED%95%9C-%EC%A3%BC%EA%B0%80-%EB%8D%B0%EC%9D%B4%ED%84%B0%EC%85%8B-%EC%83%9D%EC%84%B1" aria-hidden="true"><span class="octicon octicon-link"></span></a>1-1. ë¨¸ì‹ ëŸ¬ë‹ì„ ìœ„í•œ ì£¼ê°€ ë°ì´í„°ì…‹ ìƒì„±<a class="anchor-link" href="#1-1.-%EB%A8%B8%EC%8B%A0%EB%9F%AC%EB%8B%9D%EC%9D%84-%EC%9C%84%ED%95%9C-%EC%A3%BC%EA%B0%80-%EB%8D%B0%EC%9D%B4%ED%84%B0%EC%85%8B-%EC%83%9D%EC%84%B1"> </a>
</h2>
<p>ì£¼ê°€ ë°ì´í„°ì…‹ ìƒì„± ì ˆì°¨ëŠ” <code>df2list</code> - <code>dictionary</code> - <code>MultiProcessing</code> - <code>MySQL</code> ìˆœì„œë¡œ ì§„í–‰í•œë‹¤. 4ê°€ì§€ ì ˆì°¨ë¥¼ í†µí•´ ë°ì´í„°ì…‹ì´ ë‹¬ë¼ì§€ëŠ” ê²ƒì€ ì•„ë‹ˆê³ , ì†ë„ë¥¼ ê°œì„ ì‹œí‚¤ëŠ” ë°©í–¥ìœ¼ë¡œì˜ íš¨ìœ¨ì ì¸ ì½”ë“œë¥¼ ì§œê¸° ìœ„í•œ í›ˆë ¨ ê³¼ì •ì´ë‹¤. ëŒ€ê·œëª¨ ë°ì´í„°ì…‹ì„ ë‹¤ë£¨ê¸° ìœ„í•´ì„œëŠ” íš¨ìœ¨ì ì¸ ì½”ë”©ì„ í†µí•´ ì†ë„ë¥¼ ê°œì„ í•˜ëŠ” ê²ƒë„ ì¤‘ìš”í•œ ì¼ì´ë‹¤. íŠ¹íˆ ì´ë²ˆì— ì‚¬ìš©í•˜ëŠ” ì£¼ê°€ ë°ì´í„°ì…‹ì€ ì–‘ì´ ë§ì„ ë¿ë§Œ ì•„ë‹ˆë¼, <code>fdr</code> ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì‚¬ìš©í•˜ì—¬ ì™¸ë¶€ì—ì„œ ë¶ˆëŸ¬ì™€ì•¼í•˜ê¸° ë•Œë¬¸ì— ë°ì´í„°ì…‹ì„ êµ¬ì„±í•˜ëŠ” ê²ƒë§Œ í•´ë„ ì†ë„ê°€ ìƒë‹¹íˆ ëŠë¦¬ë‹¤. ì´ëŸ¬í•œ ë¬¸ì œì ì„ í•´ê²°í•˜ê³ ì ë³¸ í¬ìŠ¤íŒ…ì—ì„œëŠ” 4ë‹¨ê³„ì— ê±¸ì¹œ ë°ì´í„°ì…‹ ìƒì„± ê³¼ì •ì„ ë³´ì—¬ì¤€ë‹¤.</p>
<p><br></p>
<h3 id="ë°ì´í„°ì…‹-ì •ì˜">
<a class="anchor" href="#%EB%8D%B0%EC%9D%B4%ED%84%B0%EC%85%8B-%EC%A0%95%EC%9D%98" aria-hidden="true"><span class="octicon octicon-link"></span></a>ë°ì´í„°ì…‹ ì •ì˜<a class="anchor-link" href="#%EB%8D%B0%EC%9D%B4%ED%84%B0%EC%85%8B-%EC%A0%95%EC%9D%98"> </a>
</h3>
<ul>
<li>
<strong><code>ì¡°ê±´</code></strong>: ì „ì²´ ì•½ 2000ê°œ ì¢…ëª© ì¤‘ 2018ë…„ ë¶€í„° ì¡´ì†í•˜ì˜€ë˜ ê¸°ì—… ì¤‘ ê±°ë˜ëŒ€ê¸ˆì´ 1000ì–µ ì´ìƒ ë°œìƒí•œ ë‚ ì§œ (ê±°ë˜ëŒ€ê¸ˆì€ ì¶”í›„ì— ìˆ˜ì • ê°€ëŠ¥) </li>
<li>
<strong><code>column</code></strong>: <strong><code>ì¡°ê±´</code></strong> ì—ì„œ ì„ ë³„í•œ íŠ¹ì • ë‚ ì§œë¥¼ D0ë¼ê³  í–ˆì„ ë•Œ, D-9, D-8, ..., D0, ì´ 10ì¼ ì¹˜ì˜ <code>Open</code>, <code>High</code>, <code>Low</code>, <code>Close</code>, <code>ê±°ë˜ëŒ€ê¸ˆ(trading_value)</code> </li>
<li>
<strong><code>label</code></strong>:  ì¡°ê±´ì— ë¶€í•©í•˜ëŠ” íŠ¹ì • ë‚ ì§œ(D0) ëŒ€ë¹„ ë‹¤ìŒë‚ (D+1) ë‚ ì§œì˜ ì¢…ê°€(close)ê°€ 2%ì´ìƒ ìƒìŠ¹í•˜ë©´ <code>1</code>, ìƒìŠ¹í•˜ì§€ ì•Šìœ¼ë©´ <code>0</code>
</li>
<li>
<strong><code>train dataset</code></strong>: 2018ë…„ 1ì›” 2ì¼ - 2020ë…„ 12ì›” 31ì¼ (2ë…„)</li>
<li>
<strong><code>test dataset</code></strong>: 2021ë…„ 1ì›” 2ì¼ ~ 2021ë…„ 6ì›” 31ì¼ (6ê°œì›”)</li>
</ul>
<p><br></p>
<h3 id="ë°ì´í„°ì…‹-ìƒì„±-ê³¼ì œ">
<a class="anchor" href="#%EB%8D%B0%EC%9D%B4%ED%84%B0%EC%85%8B-%EC%83%9D%EC%84%B1-%EA%B3%BC%EC%A0%9C" aria-hidden="true"><span class="octicon octicon-link"></span></a>ë°ì´í„°ì…‹ ìƒì„± ê³¼ì œ<a class="anchor-link" href="#%EB%8D%B0%EC%9D%B4%ED%84%B0%EC%85%8B-%EC%83%9D%EC%84%B1-%EA%B3%BC%EC%A0%9C"> </a>
</h3>
<p>ë°ì´í„°ì…‹ ìƒì„±ì„ ì´ 3ê°€ì§€ ê³¼ì œë¡œ ë‚˜ëˆ„ì–´ ì§„í–‰í•œë‹¤.</p>
<ul>
<li>
<strong><code>ê³¼ì œ I</code></strong>: ì¢…ëª© ë¦¬ìŠ¤íŠ¸ ìƒì„±-2018ë…„ ë¶€í„° ì¡´ì†í•˜ì˜€ë˜ ê¸°ì—…(ìƒì¥ì¼ 2018ë…„ 1ì›” 1ì¼ ì´ì „ ê¸°ì—…)  ì„ ë³„</li>
<li>
<strong><code>ê³¼ì œ II</code></strong>: <strong><code>ê³¼ì œI</code></strong> ì˜ ê¸°ì—… ì¤‘ ê±°ë˜ëŒ€ê¸ˆì´ 1000ì–µ ì´ìƒ ë°œìƒí–ˆë˜ íŠ¹ì • ë‚ ì§œ ì„ ë³„ (<code>ê±°ë˜ëŒ€ê¸ˆ</code>=<code>ê±°ë˜ëŸ‰</code>X<code>ì¢…ê°€</code> ë¡œ ê³„ì‚°)</li>
<li>
<strong><code>ê³¼ì œ III</code></strong>: <strong><code>ê³¼ì œII</code></strong> ì˜ ë‚ ì§œì— ëŒ€í•´ ìµœì¢… ë¨¸ì‹ ëŸ¬ë‹ ë°ì´í„° ìƒì„±</li>
</ul>
<p><br></p>
<h3 id="ëª©ì°¨">
<a class="anchor" href="#%EB%AA%A9%EC%B0%A8" aria-hidden="true"><span class="octicon octicon-link"></span></a>ëª©ì°¨<a class="anchor-link" href="#%EB%AA%A9%EC%B0%A8"> </a>
</h3>
<ul>
<li>
<strong>(0)</strong> Finance Data Readerë¥¼ ì´ìš©í•œ ì£¼ê°€ ë°ì´í„°ì…‹ - <code>DataFrame</code>
</li>
<li>
<strong>(1)</strong> Finance Data Readerë¥¼ ì´ìš©í•œ ì£¼ê°€ ë°ì´í„°ì…‹ - <code>df2list</code>
</li>
<li>
<strong>(2)</strong> Finance Data Readerë¥¼ ì´ìš©í•œ ì£¼ê°€ ë°ì´í„°ì…‹ - <code>dictionary</code>
</li>
<li>
<strong>(3)</strong> Finance Data Readerë¥¼ ì´ìš©í•œ ì£¼ê°€ ë°ì´í„°ì…‹ - <code>MultiProcessing</code>
</li>
<li>
<strong>(4)</strong> Finance Data Readerë¥¼ ì´ìš©í•œ ì£¼ê°€ ë°ì´í„°ì…‹ - <code>MySQL</code>
</li>
<li>
<strong>(5)</strong> ìµœì¢… ë¨¸ì‹ ëŸ¬ë‹ ë°ì´í„°ì…‹ </li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="í•„ìš”-ë¼ì´ë¸ŒëŸ¬ë¦¬-import">
<a class="anchor" href="#%ED%95%84%EC%9A%94-%EB%9D%BC%EC%9D%B4%EB%B8%8C%EB%9F%AC%EB%A6%AC-import" aria-hidden="true"><span class="octicon octicon-link"></span></a>í•„ìš” ë¼ì´ë¸ŒëŸ¬ë¦¬ <strong>import</strong><a class="anchor-link" href="#%ED%95%84%EC%9A%94-%EB%9D%BC%EC%9D%B4%EB%B8%8C%EB%9F%AC%EB%A6%AC-import"> </a>
</h3>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># ! pip install -U finance-datareader</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">from</span> <span class="nn">tqdm</span> <span class="kn">import</span> <span class="n">tqdm</span>
<span class="kn">import</span> <span class="nn">FinanceDataReader</span> <span class="k">as</span> <span class="nn">fdr</span>
<span class="kn">import</span> <span class="nn">time</span>

<span class="c1"># ê²½ê³  ë©”ì‹œì§€ ë¬´ì‹œ </span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="n">action</span><span class="o">=</span><span class="s1">'ignore'</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="âœ”ï¸-(0)-Finance-Data-Readerë¥¼-ì´ìš©í•œ-ì£¼ê°€-ë°ì´í„°ì…‹---DataFrame">
<a class="anchor" href="#%E2%9C%94%EF%B8%8F-(0)-Finance-Data-Reader%EB%A5%BC-%EC%9D%B4%EC%9A%A9%ED%95%9C-%EC%A3%BC%EA%B0%80-%EB%8D%B0%EC%9D%B4%ED%84%B0%EC%85%8B---DataFrame" aria-hidden="true"><span class="octicon octicon-link"></span></a>âœ”ï¸ <strong>(0)</strong> Finance Data Readerë¥¼ ì´ìš©í•œ ì£¼ê°€ ë°ì´í„°ì…‹ - <code>DataFrame</code><a class="anchor-link" href="#%E2%9C%94%EF%B8%8F-(0)-Finance-Data-Reader%EB%A5%BC-%EC%9D%B4%EC%9A%A9%ED%95%9C-%EC%A3%BC%EA%B0%80-%EB%8D%B0%EC%9D%B4%ED%84%B0%EC%85%8B---DataFrame"> </a>
</h2>
<p>ì†ë„ ë¹„êµë¥¼ ìœ„í•´ ê¸°ì¡´ ë°ì´í„°ì˜ íƒ€ì…ì¸ <code>DataFrame</code>ì„ ì‚¬ìš©í•˜ì—¬ ë°ì´í„°ì…‹ì„ ìƒì„±í•œë‹¤. ì—°êµ¬ ì¸í„´ ì´ˆê¸° ì²«ë²ˆì§¸ë¡œ ì‘ì„±í–ˆë˜ ì½”ë“œë“¤ì¸ë°, ê°œì„ í•´ì•¼ í•  ë¶€ë¶„ë“¤ì´ ë§ë‹¤.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>ê³¼ì œ I</strong></p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_html</span><span class="p">(</span><span class="s1">'http://kind.krx.co.kr/corpgeneral/corpList.do?method=download'</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="mi">0</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

<span class="c1"># íšŒì‚¬ëª…, ì¢…ëª©ì½”ë“œ, ìƒì¥ì¼ ì»¬ëŸ¼ë§Œ ì‚¬ìš© </span>
<span class="n">df_code</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="s1">'íšŒì‚¬ëª…'</span><span class="p">,</span> <span class="s1">'ì¢…ëª©ì½”ë“œ'</span><span class="p">,</span> <span class="s1">'ìƒì¥ì¼'</span><span class="p">]]</span>

<span class="c1"># ì¢…ëª©ì½”ë“œë¥¼ 6ìë¦¬ë¡œ ë§ì¶° ì¤€ë‹¤. </span>
<span class="n">df_code</span><span class="p">[</span><span class="s1">'ì¢…ëª©ì½”ë“œ'</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_code</span><span class="p">[</span><span class="s1">'ì¢…ëª©ì½”ë“œ'</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">zfill</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span>
<span class="n">display</span><span class="p">(</span><span class="n">df_code</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<span class="nb">print</span><span class="p">()</span>

<span class="c1"># ìƒì¥ì¼ì´ 2018ë…„ 1ì›” 1ì¼ ì´ì „ì¸ ì¢…ëª©ì½”ë“œ ì„ ë³„ </span>
<span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="n">lst_code</span> <span class="o">=</span> <span class="n">df_code</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df_code</span><span class="p">[</span><span class="s1">'ìƒì¥ì¼'</span><span class="p">]</span> <span class="o">&lt;</span> <span class="s1">'2018-01-01'</span><span class="p">,</span> <span class="s1">'ì¢…ëª©ì½”ë“œ'</span><span class="p">]</span><span class="o">.</span><span class="n">to_list</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"ê±¸ë¦° ì‹œê°„: "</span><span class="p">,</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">'ìƒì¥ì¼ 2018-01-01 ì´ì „ ì¢…ëª©ì½”ë“œ: '</span><span class="p">,</span> <span class="n">lst_code</span><span class="p">[:</span><span class="mi">5</span><span class="p">])</span>
<span class="nb">print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">'ì´ </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">df_code</span><span class="p">)</span><span class="si">}</span><span class="s1"> ê°œì˜ ì¢…ëª© ì¤‘ </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">lst_code</span><span class="p">)</span><span class="si">}</span><span class="s1"> ê°œì˜ ì¢…ëª© ì„ ë³„'</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>íšŒì‚¬ëª…</th>
      <th>ì¢…ëª©ì½”ë“œ</th>
      <th>ìƒì¥ì¼</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>DL</td>
      <td>000210</td>
      <td>1976-02-02</td>
    </tr>
    <tr>
      <th>1</th>
      <td>DRBë™ì¼</td>
      <td>004840</td>
      <td>1976-05-21</td>
    </tr>
    <tr>
      <th>2</th>
      <td>DSR</td>
      <td>155660</td>
      <td>2013-05-15</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>
ê±¸ë¦° ì‹œê°„:  0.0006933212280273438

ìƒì¥ì¼ 2018-01-01 ì´ì „ ì¢…ëª©ì½”ë“œ:  ['000210', '004840', '155660', '078930', '001390']

ì´ 2507 ê°œì˜ ì¢…ëª© ì¤‘ 1977 ê°œì˜ ì¢…ëª© ì„ ë³„
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>ê³¼ì œ II</strong></p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">stock_dict</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">code</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="n">lst_code</span><span class="p">):</span> 
    <span class="n">stock</span> <span class="o">=</span> <span class="n">fdr</span><span class="o">.</span><span class="n">DataReader</span><span class="p">(</span><span class="n">code</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="s1">'20180101'</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">'20201231'</span><span class="p">)</span>
    <span class="n">stock</span><span class="p">[</span><span class="s1">'trading'</span><span class="p">]</span> <span class="o">=</span> <span class="n">stock</span><span class="p">[</span><span class="s1">'Volume'</span><span class="p">]</span> <span class="o">*</span> <span class="n">stock</span><span class="p">[</span><span class="s1">'Close'</span><span class="p">]</span> <span class="c1"># ê±°ë˜ëŒ€ê¸ˆ ì»¬ëŸ¼ ì¶”ê°€</span>
    
    <span class="k">if</span> <span class="nb">sum</span><span class="p">(</span><span class="n">stock</span><span class="p">[</span><span class="s1">'trading'</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">100000000000</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">:</span> <span class="c1"># ê±°ë˜ëŒ€ê¸ˆì´ 1000ì–µ ì´ìƒì¸ ë°ì´í„°ê°€ í•˜ë‚˜ ì´ìƒ ì¡´ì¬í•˜ë©´</span>
        <span class="n">stock_dict</span><span class="p">[</span><span class="n">code</span><span class="p">]</span> <span class="o">=</span> <span class="n">stock</span><span class="p">[</span><span class="n">stock</span><span class="p">[</span><span class="s1">'trading'</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">100000000000</span><span class="p">]</span><span class="o">.</span><span class="n">index</span> 

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">'ì´ </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">lst_code</span><span class="p">)</span><span class="si">}</span><span class="s1"> ê°œì˜ ì¢…ëª© ì¤‘ </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">stock_dict</span><span class="p">)</span><span class="si">}</span><span class="s1"> ê°œì˜ ì¢…ëª© ì‚¬ìš©'</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1977/1977 [02:58&lt;00:00, 11.08it/s]</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>ì´ 1977 ê°œì˜ ì¢…ëª© ì¤‘ 799 ê°œì˜ ì¢…ëª© ì‚¬ìš©
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>
</pre>
</div>
</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">lst_code_date</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">code</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="n">stock_dict</span><span class="p">):</span> 
    <span class="k">for</span> <span class="n">date</span> <span class="ow">in</span> <span class="p">(</span><span class="n">stock_dict</span><span class="p">[</span><span class="n">code</span><span class="p">]):</span>
        <span class="n">lst_code_date</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">code</span><span class="p">,</span> <span class="n">date</span><span class="p">])</span>
        
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">'ì„ ë³„ëœ ë‚ ì§œëŠ” ì´ </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">lst_code_date</span><span class="p">)</span><span class="si">}</span><span class="s1">ê°œ'</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 799/799 [00:00&lt;00:00, 13125.89it/s]</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>ì„ ë³„ëœ ë‚ ì§œëŠ” ì´ 14182ê°œ
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>ê³¼ì œ III</strong></p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">data_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">'code'</span><span class="p">:</span> <span class="p">[],</span> <span class="s1">'d0'</span><span class="p">:</span> <span class="p">[],</span> <span class="s1">'info'</span><span class="p">:</span> <span class="p">[],</span> <span class="s1">'up'</span><span class="p">:</span> <span class="p">[]}</span>
<span class="k">for</span> <span class="n">code</span><span class="p">,</span> <span class="n">date</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="n">lst_code_date</span><span class="p">):</span>
    <span class="n">start_date</span> <span class="o">=</span> <span class="s1">'20171201'</span> <span class="c1"># 2018ë…„ ì´ˆë°˜ ë‚ ì§œê°€ D0ë¼ë©´ 2017ë…„ ë°ì´í„° í•„ìš” (D-9~D-1)</span>
    <span class="n">end_date</span> <span class="o">=</span> <span class="s1">'20210130'</span> <span class="c1"># 2020ë…„ í›„ë°˜ ë‚ ì§œê°€ D0ë¼ë©´ 2021ë…„ ë°ì´í„° í•„ìš” (D+1) </span>
    <span class="n">stock</span> <span class="o">=</span> <span class="n">fdr</span><span class="o">.</span><span class="n">DataReader</span><span class="p">(</span><span class="n">code</span><span class="p">,</span> <span class="n">start</span> <span class="o">=</span> <span class="n">start_date</span><span class="p">,</span> <span class="n">end</span> <span class="o">=</span> <span class="n">end_date</span><span class="p">)</span>
    <span class="n">stock</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="c1"># 'Date' index -&gt; column </span>
    
    <span class="n">D9_index</span> <span class="o">=</span> <span class="n">stock</span><span class="p">[</span><span class="n">stock</span><span class="p">[</span><span class="s1">'Date'</span><span class="p">]</span> <span class="o">==</span> <span class="nb">str</span><span class="p">(</span><span class="n">date</span><span class="p">)]</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mi">9</span> <span class="c1"># D-9 ë‚ ì§œì˜ ì¸ë±ìŠ¤  </span>
    <span class="n">next_index</span> <span class="o">=</span> <span class="n">stock</span><span class="p">[</span><span class="n">stock</span><span class="p">[</span><span class="s1">'Date'</span><span class="p">]</span> <span class="o">==</span> <span class="nb">str</span><span class="p">(</span><span class="n">date</span><span class="p">)]</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span> <span class="c1"># D+1 ë‚ ì§œì˜ ì¸ë±ìŠ¤  </span>
        
    <span class="c1"># ì¢…ëª©ì½”ë“œ (code)</span>
    <span class="n">data_dict</span><span class="p">[</span><span class="s1">'code'</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">code</span><span class="p">)</span> 
    
    <span class="c1"># ê¸°ì¤€ì¼ (d0)</span>
    <span class="n">data_dict</span><span class="p">[</span><span class="s1">'d0'</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">date</span><span class="p">)</span>
    
    <span class="c1"># D-9 ~ D+1, ì´ 11ì¼ì¹˜ì˜ sub stock DataFrame ìƒì„± </span>
    <span class="n">sub_stock</span> <span class="o">=</span> <span class="n">stock</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">D9_index</span><span class="p">:</span><span class="n">next_index</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">sub_stock</span><span class="p">[</span><span class="s1">'trading'</span><span class="p">]</span> <span class="o">=</span> <span class="n">sub_stock</span><span class="p">[</span><span class="s1">'Close'</span><span class="p">]</span> <span class="o">*</span> <span class="n">sub_stock</span><span class="p">[</span><span class="s1">'Volume'</span><span class="p">]</span> <span class="c1"># ê±°ë˜ëŒ€ê¸ˆ ì»¬ëŸ¼ ì¶”ê°€ </span>
   
    
    <span class="c1"># 10ì¼ ê°„ì˜ ë°ì´í„° (info)</span>
    <span class="n">info_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>        
        <span class="n">info_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sub_stock</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]]</span><span class="o">.</span><span class="n">to_list</span><span class="p">())</span>
    <span class="n">remove_list</span><span class="o">=</span><span class="p">[</span><span class="s1">'['</span><span class="p">,</span> <span class="s1">']'</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">):</span> 
        <span class="n">info_list</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">'</span><span class="si">{</span><span class="n">info_list</span><span class="si">}</span><span class="s1">'</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">remove_list</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="s1">''</span><span class="p">)</span>
    <span class="n">data_dict</span><span class="p">[</span><span class="s1">'info'</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">info_list</span><span class="p">)</span>    
        
        
    <span class="c1"># D+1 ì¢…ê°€ 2% ìƒìŠ¹ ì—¬ë¶€ (up)</span>
    <span class="n">up</span> <span class="o">=</span> <span class="n">sub_stock</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">][</span><span class="s1">'Close'</span><span class="p">]</span> <span class="o">+</span> <span class="mf">0.02</span> <span class="o">*</span> <span class="n">sub_stock</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">][</span><span class="s1">'Close'</span><span class="p">]</span>
    
    <span class="k">if</span> <span class="n">sub_stock</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="s1">'Close'</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">up</span><span class="p">:</span> 
        <span class="n">data_dict</span><span class="p">[</span><span class="s1">'up'</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span> 
        <span class="n">data_dict</span><span class="p">[</span><span class="s1">'up'</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 14182/14182 [17:08&lt;00:00, 13.78it/s]
</pre>
</div>
</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_result</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data_dict</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">df_result</span><span class="o">.</span><span class="n">head</span><span class="p">())</span> 

<span class="c1"># ìµœì¢… ê²°ê³¼ ë°ì´í„°ì…‹ txt íŒŒì¼ ì €ì¥ </span>
<span class="n">df_result</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s2">"assignment3.txt"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">'ìƒì„±ëœ ë°ì´í„°ì˜ ê°œìˆ˜ëŠ” </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">"assignment3.txt"</span><span class="p">))</span><span class="si">}</span><span class="s1"> ê°œ'</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>code</th>
      <th>d0</th>
      <th>info</th>
      <th>up</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>000210</td>
      <td>2018-01-26</td>
      <td>78343, 78614, 76987, 77892, 9590608284, 77801,...</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>000210</td>
      <td>2018-08-08</td>
      <td>68855, 69397, 67590, 69036, 6067435968, 69487,...</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>000210</td>
      <td>2020-04-02</td>
      <td>44819, 52951, 44322, 51145, 15615437965, 47439...</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>000210</td>
      <td>2020-09-11</td>
      <td>80783, 84487, 78524, 78524, 61554885076, 79608...</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>000210</td>
      <td>2020-12-11</td>
      <td>76174, 76174, 72289, 72289, 76043112348, 72831...</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>ìƒì„±ëœ ë°ì´í„°ì˜ ê°œìˆ˜ëŠ” 14182 ê°œ
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>ê°œì„ í•´ì•¼í•  ì‚¬í•­</strong></p>
<ul>
<li>
<strong><code>ì†ë„ ê°œì„ </code></strong>: <strong><code>ê³¼ì œIII</code></strong> ì€ ì•½ 17ë¶„ì´ ê±¸ë¦° ê²ƒì„ ë³´ì•„ ì†ë„ ë©´ì—ì„œ ìƒë‹¹íˆ ë¹„íš¨ìœ¨ì ì´ì—ˆë‹¤ëŠ” ê²ƒì„ ì•Œ ìˆ˜ ìˆë‹¤. (ê±°ë˜ëŒ€ê¸ˆì„ 10ì–µìœ¼ë¡œ ì„¤ì •í–ˆì„ ë•Œ 1% ì§„í–‰ì— 5ë¶„ì´ ê±¸ë ¸ë‹¤. ê·¸ëŸ¼ ì´ 500ë¶„ì´ ê±¸ë¦´ ê²ƒìœ¼ë¡œ ì˜ˆìƒí•  ìˆ˜ ìˆë‹¤.)</li>
</ul>
<ul>
<li>
<strong><code># 10ì¼ ê°„ì˜ ë°ì´í„°</code></strong> ë¶€ë¶„: <code>info_list</code>ì— ë°ì´í„°ë¥¼ ì¶”ê°€í•˜ëŠ” ê³¼ì •ì—ì„œ ì–µì§€ë¡œ í¬ë§·ì„ ë§ì¶”ê¸° ìœ„í•´ ë¶ˆí•„ìš”í•œ <code>forë¬¸</code>ì´ ë“¤ì–´ê°”ë‹¤. </li>
</ul>
<ul>
<li>
<strong><code># D+1 ì¢…ê°€ 2% ìƒìŠ¹ ì—¬ë¶€</code></strong> ë¶€ë¶„: ì „ ë‚  ëŒ€ë¹„ 2% ìƒìŠ¹ìœ¨ì„ ì§ì ‘ ê³„ì‚°í•´ ì£¼ì—ˆëŠ”ë°, ì´ë¯¸ ë³€í™”ìœ¨ì´ ê³„ì‚° ë˜ì–´ ìˆëŠ” <code>change</code>ë¼ëŠ” ì»¬ëŸ¼ì„ ì‚¬ìš©í•˜ëŠ” ê²ƒìœ¼ë¡œ ëŒ€ì²´í•œë‹¤. </li>
</ul>
<ul>
<li>
<strong><code>txt íŒŒì¼ ì €ì¥</code></strong>: <code>DataFrame</code>ìœ¼ë¡œ ìƒì„±ì„ í•œ í›„ì— <code>txt</code> íŒŒì¼ë¡œ ì €ì¥í–ˆëŠ”ë°, ë°ì´í„° ìƒì„± ì‹œ íŒŒì¼ ì…ì¶œë ¥ <code>write()</code>ë¥¼ ì‚¬ìš©í•´ì„œ ë°”ë¡œ <code>txt</code> íŒŒì¼ë¡œ  ì €ì¥í•˜ëŠ” ë°©ì‹ìœ¼ë¡œ ë³€ê²½í•œë‹¤. </li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<hr>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="âœ”ï¸-(1)-Finance-Data-Readerë¥¼-ì´ìš©í•œ-ì£¼ê°€-ë°ì´í„°ì…‹---df2list">
<a class="anchor" href="#%E2%9C%94%EF%B8%8F-(1)-Finance-Data-Reader%EB%A5%BC-%EC%9D%B4%EC%9A%A9%ED%95%9C-%EC%A3%BC%EA%B0%80-%EB%8D%B0%EC%9D%B4%ED%84%B0%EC%85%8B---df2list" aria-hidden="true"><span class="octicon octicon-link"></span></a>âœ”ï¸ (1) Finance Data Readerë¥¼ ì´ìš©í•œ ì£¼ê°€ ë°ì´í„°ì…‹ - <code>df2list</code><a class="anchor-link" href="#%E2%9C%94%EF%B8%8F-(1)-Finance-Data-Reader%EB%A5%BC-%EC%9D%B4%EC%9A%A9%ED%95%9C-%EC%A3%BC%EA%B0%80-%EB%8D%B0%EC%9D%B4%ED%84%B0%EC%85%8B---df2list"> </a>
</h2>
<p>ì²«ë²ˆì§¸ ë°©ë²•ì€ <code>DataFrame</code> ì‚¬ìš©ì„ ì§€ì–‘í•˜ê³ , <code>python</code>ì˜ ê¸°ë³¸ ë°ì´í„° íƒ€ì…ì¸ <code>list</code>ë¡œ ë°”ê¾¸ì–´ ì‚¬ìš©í•˜ëŠ” ë°©ë²•ì´ë‹¤. ì´ë¡œì¨ <code>column</code> ì¤‘ì‹¬ì˜ ì—°ì‚°ì„ <code>row</code> ì¤‘ì‹¬ì˜ ì—°ì‚°ìœ¼ë¡œ ë°”ê¾¸ì–´ì¤€ë‹¤. ì´ ë°©ë²•ì—ì„œëŠ” ì†ë„ ê°œì„  ë³´ë‹¤ëŠ” <code>(0)</code>ë²ˆ ë°©ë²•ì˜ ì½”ë“œì—ì„œ íš¨ìœ¨ì ì´ì§€ ëª»í–ˆë˜ ë¶€ë¶„ì„ ê³ ì¹˜ê³  ê¹”ë”í•œ ì½”ë“œë¡œ ë³´ì™„í•œë‹¤.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>ê³¼ì œ I</strong></p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">display</span><span class="p">(</span><span class="n">df_code</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>

<span class="c1"># ğŸŒŸ dataframe -&gt; list </span>
<span class="n">lst_stock</span> <span class="o">=</span> <span class="n">df_code</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">lst_stock</span><span class="p">[:</span><span class="mi">2</span><span class="p">])</span>
<span class="nb">print</span><span class="p">()</span>


<span class="n">lst_code</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># ì„ ë³„ ëœ ì½”ë“œë¥¼ ë‹´ì„ ë¦¬ìŠ¤íŠ¸ </span>
<span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">lst_stock</span><span class="p">:</span>
    <span class="n">code</span><span class="p">,</span> <span class="n">date</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">row</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">date</span> <span class="o">&lt;=</span> <span class="s1">'2018-01-01'</span><span class="p">:</span>
        <span class="n">lst_code</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">code</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"ê±¸ë¦° ì‹œê°„: "</span><span class="p">,</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>

        
<span class="nb">print</span><span class="p">(</span><span class="s1">'ìƒì¥ì¼ 2018-01-01 ì´ì „ ì¢…ëª©ì½”ë“œ: '</span><span class="p">,</span> <span class="n">lst_code</span><span class="p">[:</span><span class="mi">4</span><span class="p">])</span>
<span class="nb">print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">'ì´ </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">df_code</span><span class="p">)</span><span class="si">}</span><span class="s1"> ê°œì˜ ì¢…ëª© ì¤‘ </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">lst_code</span><span class="p">)</span><span class="si">}</span><span class="s1"> ê°œì˜ ì¢…ëª© ì„ ë³„'</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>íšŒì‚¬ëª…</th>
      <th>ì¢…ëª©ì½”ë“œ</th>
      <th>ìƒì¥ì¼</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>DL</td>
      <td>000210</td>
      <td>1976-02-02</td>
    </tr>
    <tr>
      <th>1</th>
      <td>DRBë™ì¼</td>
      <td>004840</td>
      <td>1976-05-21</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[['DL', '000210', '1976-02-02'], ['DRBë™ì¼', '004840', '1976-05-21']]

ê±¸ë¦° ì‹œê°„:  0.0004284381866455078

ìƒì¥ì¼ 2018-01-01 ì´ì „ ì¢…ëª©ì½”ë“œ:  ['000210', '004840', '155660', '078930']

ì´ 2507 ê°œì˜ ì¢…ëª© ì¤‘ 1977 ê°œì˜ ì¢…ëª© ì„ ë³„
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>ê³¼ì œ II</strong></p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">lst_code_date</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">code</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="n">lst_code</span><span class="p">):</span>
    <span class="n">stock</span> <span class="o">=</span> <span class="n">fdr</span><span class="o">.</span><span class="n">DataReader</span><span class="p">(</span><span class="n">code</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="s1">'20180102'</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">'20201231'</span><span class="p">)</span>
    <span class="n">stock</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    
    <span class="c1"># ğŸŒŸ dataframe -&gt; list </span>
    <span class="n">lst_stock</span> <span class="o">=</span> <span class="n">stock</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
    
    <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">lst_stock</span><span class="p">:</span> 
        <span class="n">date</span><span class="p">,</span> <span class="n">trading_value</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">row</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">*</span><span class="n">row</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">trading_value</span> <span class="o">&gt;=</span> <span class="mi">100000000000</span><span class="p">:</span>  <span class="c1"># ê±°ë˜ëŒ€ê¸ˆ 1000ì–µ ì´ìƒ</span>
            <span class="n">lst_code_date</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">code</span><span class="p">,</span> <span class="n">date</span><span class="o">.</span><span class="n">date</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">"%Y%m</span><span class="si">%d</span><span class="s2">"</span><span class="p">)])</span>
            
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">'ì„ ë³„ëœ ë‚ ì§œëŠ” ì´ </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">lst_code_date</span><span class="p">)</span><span class="si">}</span><span class="s1">ê°œ'</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1977/1977 [02:55&lt;00:00, 11.26it/s]</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>ì„ ë³„ëœ ë‚ ì§œëŠ” ì´ 14182ê°œ
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>ê³¼ì œ III</strong></p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">OF</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s1">'assignment3.txt'</span><span class="p">,</span><span class="s1">'w'</span><span class="p">)</span>

<span class="k">for</span> <span class="n">code</span><span class="p">,</span> <span class="n">date</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="n">lst_code_date</span><span class="p">):</span>
    <span class="n">start_date</span> <span class="o">=</span> <span class="s1">'20180101'</span> 
    <span class="n">end_date</span> <span class="o">=</span> <span class="s1">'20201231'</span> 
    <span class="n">stock</span> <span class="o">=</span> <span class="n">fdr</span><span class="o">.</span><span class="n">DataReader</span><span class="p">(</span><span class="n">code</span><span class="p">,</span> <span class="n">start</span> <span class="o">=</span> <span class="n">start_date</span><span class="p">,</span> <span class="n">end</span> <span class="o">=</span> <span class="n">end_date</span><span class="p">)</span>
    <span class="n">stock</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="c1"># 'Date' index -&gt; column </span>
    
    
    <span class="c1"># ğŸŒŸ dataframe -&gt; list </span>
    <span class="n">lst_stock</span> <span class="o">=</span> <span class="n">stock</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
    
    
    <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">lst_stock</span><span class="p">):</span> 
        <span class="k">if</span> <span class="p">(</span><span class="n">idx</span> <span class="o">&lt;</span> <span class="mi">9</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">idx</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="n">lst_stock</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span> <span class="c1"># ì˜ˆì™¸ ì²˜ë¦¬ </span>
            <span class="k">continue</span> 
        
        <span class="k">if</span> <span class="n">row</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">date</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">"%Y%m</span><span class="si">%d</span><span class="s2">"</span><span class="p">)</span> <span class="o">==</span> <span class="n">date</span><span class="p">:</span> 
            
            <span class="c1"># D-9 ~ D0 ë°ì´í„°ë§Œ ë‹´ê¸°</span>
            <span class="n">sub_stock</span> <span class="o">=</span> <span class="n">lst_stock</span><span class="p">[</span><span class="n">idx</span><span class="o">-</span><span class="mi">9</span><span class="p">:</span><span class="n">idx</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
            
            <span class="c1"># 10ì¼ ê°„ì˜ ë°ì´í„° </span>
            <span class="n">lst_info</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">row2</span> <span class="ow">in</span> <span class="n">sub_stock</span><span class="p">:</span>
                <span class="n">lst_prices</span><span class="p">,</span> <span class="n">trading_value</span> <span class="o">=</span> <span class="n">row2</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">5</span><span class="p">],</span> <span class="n">row</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">*</span><span class="n">row</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span>
                <span class="n">lst_info</span> <span class="o">+=</span> <span class="n">lst_prices</span> <span class="o">+</span> <span class="p">[</span><span class="n">trading_value</span><span class="p">]</span>
                
            <span class="n">info</span> <span class="o">=</span> <span class="s1">','</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">lst_info</span><span class="p">))</span>
            
            <span class="c1"># D+1 ì¢…ê°€ 2% ìƒìŠ¹ ì—¬ë¶€ (up)</span>
            <span class="n">change</span> <span class="o">=</span> <span class="n">lst_stock</span><span class="p">[</span><span class="n">idx</span><span class="o">+</span><span class="mi">1</span><span class="p">][</span><span class="mi">6</span><span class="p">]</span>
            <span class="n">label</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">change</span> <span class="o">&gt;=</span> <span class="mf">0.02</span><span class="p">)</span>
            
            <span class="c1"># ì €ì¥ </span>
            <span class="n">OF</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s1">'</span><span class="si">{</span><span class="n">code</span><span class="si">}</span><span class="se">\t</span><span class="si">{</span><span class="n">date</span><span class="si">}</span><span class="se">\t</span><span class="si">{</span><span class="n">lst_info</span><span class="si">}</span><span class="se">\t</span><span class="si">{</span><span class="n">label</span><span class="si">}</span><span class="se">\n</span><span class="s1">'</span><span class="p">)</span>
            
<span class="n">OF</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">'ìƒì„±ëœ ë°ì´í„°ì˜ ê°œìˆ˜ëŠ” </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">"assignment3.txt"</span><span class="p">))</span><span class="si">}</span><span class="s1"> ê°œ'</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 14182/14182 [17:43&lt;00:00, 13.33it/s]</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>ìƒì„±ëœ ë°ì´í„°ì˜ ê°œìˆ˜ëŠ” 13939 ê°œ
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>
<code>OF.write()</code>ë¥¼ ì‚¬ìš©í•¨ìœ¼ë¡œì¨ ë¸”í•„ìš”í•œ <code>DataFrame</code> ì„ ìƒì„±í•˜ì§€ ì•ŠëŠ”ë‹¤.</li>
</ul>
<ul>
<li>
<strong># 10ì¼ê°„ì˜ ë°ì´í„°</strong> ë¶€ë¶„ì€ <code>join()</code> í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ì—¬ ë¶ˆí•„ìš”í•œ forë¬¸ ì‚¬ìš©ì„ ì¤„ì˜€ê³ , <strong># D+1 ì¢…ê°€ 2% ìƒìŠ¹ ì—¬ë¶€ (up)</strong> ë¶€ë¶„ì€ ì „ë‚  ëŒ€ë¹„ ì¢…ê°€ ë³€í™”ìœ¨ì„ ê³„ì‚°í•˜ì§€ ì•Šê³  <code>change</code> ì»¬ëŸ¼ì„ í™œìš©í•˜ëŠ” ê²ƒìœ¼ë¡œ ë°”ê¾¸ì—ˆë‹¤. </li>
</ul>
<ul>
<li>
<strong><code>ì†ë„ì— ëŒ€í•œ ë¬¸ì œì </code></strong> : ì „ ë³´ë‹¤ ê¹”ë”í•œ ì½”ë“œë¡œ ë³´ì™„ì´ ë˜ì—ˆì§€ë§Œ, ì•„ì§ ì†ë„ì— ëŒ€í•œ ë¬¸ì œì ì´ ë‚¨ì•„ìˆë‹¤. ì†ë„ë¥¼ ê°œì„ í•˜ê¸° ìœ„í•´ì„œëŠ” <code>fdr</code> ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ìµœì†Œí•œìœ¼ë¡œ ì‚¬ìš©í•´ì•¼ í•œë‹¤. ì´ë¥¼ í•´ê²°í•˜ê¸° ìœ„í•´ <code>dictionary</code>ë¥¼ ì‚¬ìš©í•˜ëŠ” ë°©ë²•ìœ¼ë¡œ ë„˜ì–´ê°„ë‹¤. </li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<hr>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="âœ”ï¸-(2)-Finance-Data-Readerë¥¼-ì´ìš©í•œ-ì£¼ê°€-ë°ì´í„°ì…‹---dictionary">
<a class="anchor" href="#%E2%9C%94%EF%B8%8F-(2)-Finance-Data-Reader%EB%A5%BC-%EC%9D%B4%EC%9A%A9%ED%95%9C-%EC%A3%BC%EA%B0%80-%EB%8D%B0%EC%9D%B4%ED%84%B0%EC%85%8B---dictionary" aria-hidden="true"><span class="octicon octicon-link"></span></a>âœ”ï¸ (2) Finance Data Readerë¥¼ ì´ìš©í•œ ì£¼ê°€ ë°ì´í„°ì…‹ - <code>dictionary</code><a class="anchor-link" href="#%E2%9C%94%EF%B8%8F-(2)-Finance-Data-Reader%EB%A5%BC-%EC%9D%B4%EC%9A%A9%ED%95%9C-%EC%A3%BC%EA%B0%80-%EB%8D%B0%EC%9D%B4%ED%84%B0%EC%85%8B---dictionary"> </a>
</h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>dictionary</code>ë¥¼ ì‚¬ìš©í•˜ëŠ” ë°©ë²•ì€ <strong><code>ê³¼ì œIII</code></strong> ì˜ ì†ë„ë¥¼ ê°œì„ í•œë‹¤. <code>fdr</code> ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ìµœì†Œí•œìœ¼ë¡œ ì‚¬ìš©í•˜ê³ , <code>for</code>ë¬¸ì„ ìµœëŒ€í•œ ì¤„ì¸ë‹¤. í˜„ì¬ ë¬¸ì œì ì€ ë‚ ì§œë¥¼ ê¸°ì¤€ìœ¼ë¡œ <code>for</code>ë¬¸ì´ ëŒì•„ê°€ê¸° ë•Œë¬¸ì— ê°™ì€ ë°ì´í„°(ê°™ì€ ì¢…ëª©)ê°€ ì—¬ëŸ¬ë²ˆ ë¶ˆëŸ¬ì™€ì§€ëŠ” ê²½ìš°ê°€ ë‹¤ìˆ˜ ì¡´ì¬í•œë‹¤ëŠ” ê²ƒì´ë‹¤. ë”°ë¼ì„œ <strong><code>ê³¼ì œII</code></strong> ì—ì„œ <code>code</code>ë³„ <code>D0</code> ë‚ ì§œ ë¦¬ìŠ¤íŠ¸ë¥¼ <code>dictionary</code> íƒ€ì…ìœ¼ë¡œ ìƒì„±í•˜ê³ , <strong><code>ê³¼ì œIII</code></strong> ì—ì„œ <code>code</code> ë‹¹ í•œë²ˆë§Œ <code>fdr</code> ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì‚¬ìš©í•˜ë„ë¡ ë°”ê¾¸ì–´ ì¤€ë‹¤.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>ê³¼ì œ I</strong></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong><code>ê³¼ì œI</code></strong> ì€ ì•ì˜ ë°©ë²•ê³¼ ê°™ìœ¼ë¯€ë¡œ ìƒëµí•œë‹¤.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">'ìƒì¥ì¼ 2018-01-01 ì´ì „ ì¢…ëª©ì½”ë“œ: '</span><span class="p">,</span> <span class="n">lst_code</span><span class="p">[:</span><span class="mi">4</span><span class="p">])</span>
<span class="nb">print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">'ì´ </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">df_code</span><span class="p">)</span><span class="si">}</span><span class="s1"> ê°œì˜ ì¢…ëª© ì¤‘ </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">lst_code</span><span class="p">)</span><span class="si">}</span><span class="s1"> ê°œì˜ ì¢…ëª© ì„ ë³„'</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>ìƒì¥ì¼ 2018-01-01 ì´ì „ ì¢…ëª©ì½”ë“œ:  ['000210', '004840', '155660', '078930']

ì´ 2507 ê°œì˜ ì¢…ëª© ì¤‘ 1977 ê°œì˜ ì¢…ëª© ì„ ë³„
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>ê³¼ì œ II</strong></p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dict_code2date</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">code</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="n">lst_code</span><span class="p">):</span> 
    <span class="n">start_date</span> <span class="o">=</span> <span class="s1">'20180102'</span>
    <span class="n">end_date</span> <span class="o">=</span> <span class="s1">'20201231'</span>
    <span class="n">stock</span> <span class="o">=</span> <span class="n">fdr</span><span class="o">.</span><span class="n">DataReader</span><span class="p">(</span><span class="n">code</span><span class="p">,</span> <span class="n">start</span> <span class="o">=</span> <span class="n">start_date</span><span class="p">,</span> <span class="n">end</span> <span class="o">=</span> <span class="n">end_date</span><span class="p">)</span>
    <span class="n">stock</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>    
    
    <span class="c1"># ğŸŒŸ dataframe -&gt; list     </span>
    <span class="n">lst_stock</span> <span class="o">=</span> <span class="n">stock</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
    
    <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">lst_stock</span><span class="p">:</span> 
        <span class="n">date</span><span class="p">,</span> <span class="n">trading_value</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">row</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">*</span><span class="n">row</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">trading_value</span> <span class="o">&gt;=</span> <span class="mi">100000000000</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">code</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">dict_code2date</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="n">dict_code2date</span><span class="p">[</span><span class="n">code</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">date</span><span class="o">.</span><span class="n">date</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">"%Y%m</span><span class="si">%d</span><span class="s2">"</span><span class="p">)]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">dict_code2date</span><span class="p">[</span><span class="n">code</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">date</span><span class="o">.</span><span class="n">date</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">"%Y%m</span><span class="si">%d</span><span class="s2">"</span><span class="p">))</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">'ì´ </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">lst_code</span><span class="p">)</span><span class="si">}</span><span class="s1"> ê°œì˜ ì¢…ëª© ì¤‘ </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">dict_code2date</span><span class="p">)</span><span class="si">}</span><span class="s1"> ê°œì˜ ì¢…ëª© ì‚¬ìš©'</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1977/1977 [02:42&lt;00:00, 12.14it/s]</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>ì´ 1977 ê°œì˜ ì¢…ëª© ì¤‘ 799 ê°œì˜ ì¢…ëª© ì‚¬ìš©
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>ê³¼ì œ III</strong></p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">OF</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s1">'assignment3.txt'</span><span class="p">,</span> <span class="s1">'w'</span><span class="p">)</span>
<span class="k">for</span> <span class="n">code</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="n">dict_code2date</span><span class="p">):</span> 
    <span class="c1"># codeì˜ stock </span>
    <span class="n">start_date</span> <span class="o">=</span> <span class="s1">'20180101'</span> 
    <span class="n">end_date</span> <span class="o">=</span> <span class="s1">'20201231'</span> 
    <span class="n">stock</span> <span class="o">=</span> <span class="n">fdr</span><span class="o">.</span><span class="n">DataReader</span><span class="p">(</span><span class="n">code</span><span class="p">,</span> <span class="n">start</span> <span class="o">=</span> <span class="n">start_date</span><span class="p">,</span> <span class="n">end</span> <span class="o">=</span> <span class="n">end_date</span><span class="p">)</span>
    <span class="n">stock</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    
    <span class="c1"># ğŸŒŸ dataframe -&gt; list     </span>
    <span class="n">lst_stock</span> <span class="o">=</span> <span class="n">stock</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>  
       
    <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">lst_stock</span><span class="p">):</span>   
        <span class="k">if</span> <span class="p">(</span><span class="n">idx</span> <span class="o">&lt;</span> <span class="mi">9</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">idx</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="n">lst_stock</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span> <span class="c1"># ì˜ˆì™¸ ì²˜ë¦¬ </span>
            <span class="k">continue</span> 
        
        <span class="n">date</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">date</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">"%Y%m</span><span class="si">%d</span><span class="s2">"</span><span class="p">)</span> 
        <span class="k">if</span> <span class="n">date</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">dict_code2date</span><span class="p">[</span><span class="n">code</span><span class="p">]:</span> <span class="c1"># ì¡°ê±´ì— ë¶€í•©í•˜ëŠ” ë‚ ì§œ (D0 ë‚ ì§œ)ë¥¼ ë°œê²¬í•  ë•Œê¹Œì§€ continue</span>
            <span class="k">continue</span> 

        <span class="c1"># D-9 ~ D0 ë°ì´í„°ë§Œ ë‹´ê¸°</span>
        <span class="n">sub_stock</span> <span class="o">=</span> <span class="n">lst_stock</span><span class="p">[</span><span class="n">idx</span><span class="o">-</span><span class="mi">9</span><span class="p">:</span><span class="n">idx</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> 
        
        <span class="c1"># 10ì¼ê°„ì˜ ë°ì´í„° </span>
        <span class="n">lst_info</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">row2</span> <span class="ow">in</span> <span class="n">sub_stock</span><span class="p">:</span>
            <span class="n">lst_prices</span><span class="p">,</span> <span class="n">trading_value</span> <span class="o">=</span> <span class="n">row2</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">5</span><span class="p">],</span> <span class="n">row2</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">*</span><span class="n">row2</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span>
            <span class="n">lst_info</span> <span class="o">+=</span> <span class="n">lst_prices</span> <span class="o">+</span> <span class="p">[</span><span class="n">trading_value</span><span class="p">]</span>
        <span class="n">info</span> <span class="o">=</span> <span class="s1">','</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">lst_info</span><span class="p">))</span>

        <span class="c1"># D+1 ì¢…ê°€ 2% ìƒìŠ¹ ì—¬ë¶€ </span>
        <span class="n">label</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">lst_stock</span><span class="p">[</span><span class="n">idx</span><span class="o">+</span><span class="mi">1</span><span class="p">][</span><span class="mi">6</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mf">0.02</span><span class="p">)</span>

        <span class="c1"># ì €ì¥ </span>
        <span class="n">OF</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s1">'</span><span class="si">{</span><span class="n">code</span><span class="si">}</span><span class="se">\t</span><span class="si">{</span><span class="n">date</span><span class="si">}</span><span class="se">\t</span><span class="si">{</span><span class="n">info</span><span class="si">}</span><span class="se">\t</span><span class="si">{</span><span class="n">label</span><span class="si">}</span><span class="se">\n</span><span class="s1">'</span><span class="p">)</span>
                         
<span class="n">OF</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>   

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">'ìƒì„±ëœ ë°ì´í„°ì˜ ê°œìˆ˜ëŠ” </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">"assignment3.txt"</span><span class="p">))</span><span class="si">}</span><span class="s1"> ê°œ'</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 799/799 [01:07&lt;00:00, 11.84it/s]</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>ìƒì„±ëœ ë°ì´í„°ì˜ ê°œìˆ˜ëŠ” 13939 ê°œ
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>ì•½ 17ë¶„ì´ ê±¸ë¦¬ë˜ ì‹œê°„ì´ 1ë¶„ìœ¼ë¡œ ì¤„ì–´ë“¤ì—ˆë‹¤.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<hr>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="âœ”ï¸-(3)-Finance-Data-Readerë¥¼-ì´ìš©í•œ-ì£¼ê°€-ë°ì´í„°ì…‹---MultiProcessing">
<a class="anchor" href="#%E2%9C%94%EF%B8%8F-(3)-Finance-Data-Reader%EB%A5%BC-%EC%9D%B4%EC%9A%A9%ED%95%9C-%EC%A3%BC%EA%B0%80-%EB%8D%B0%EC%9D%B4%ED%84%B0%EC%85%8B---MultiProcessing" aria-hidden="true"><span class="octicon octicon-link"></span></a>âœ”ï¸ (3) Finance Data Readerë¥¼ ì´ìš©í•œ ì£¼ê°€ ë°ì´í„°ì…‹ - <code>MultiProcessing</code><a class="anchor-link" href="#%E2%9C%94%EF%B8%8F-(3)-Finance-Data-Reader%EB%A5%BC-%EC%9D%B4%EC%9A%A9%ED%95%9C-%EC%A3%BC%EA%B0%80-%EB%8D%B0%EC%9D%B4%ED%84%B0%EC%85%8B---MultiProcessing"> </a>
</h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>
<code>multi processing(ë‹¤ì¤‘ ì²˜ë¦¬)</code>: ì»´í“¨í„° ì‹œìŠ¤í…œ í•œ ëŒ€ì— ë‘ê°œ ì´ìƒì˜ ì¤‘ì•™ ì²˜ë¦¬ ì¥ì¹˜ (CPU) ë¥¼ ì´ìš©í•˜ì—¬ ë³‘ë ¬ì²˜ë¦¬í•˜ëŠ” ê²ƒ </li>
</ul>
<ul>
<li>
<code>python multi processing</code> ë¬¸ì„œ: <a href="https://docs.python.org/ko/3/library/multiprocessing.html">https://docs.python.org/ko/3/library/multiprocessing.html</a>.</li>
</ul>
<p><code>python</code>ì€ <code>multiprocessing</code> ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ í†µí•´ ë‹¤ì¤‘ ì²˜ë¦¬ë¥¼ ì§€ì›í•œë‹¤. ì—¬ëŸ¬ ê°œì˜ <code>ì½”ì–´</code>ë¥¼ ì—°ì‚°ì— ì‚¬ìš©í•¨ìœ¼ë¡œì¨ ë§ì€ ì‘ì—…ì„ ë¹ ë¥¸ ì‹œê°„ì— ì²˜ë¦¬í•´ì¤„ ìˆ˜ ìˆë‹¤ëŠ” ì¥ì ì´ ìˆë‹¤.</p>
<p><img src="/blog/images/copied_from_nb/./ghtop_images/multi_processing.png" alt="image.png">
[ <code>core=10</code>ìœ¼ë¡œ ì„¤ì •í•˜ì—¬ multi processingì„ ìˆ˜í–‰í•  ë•Œ ì½”ì–´ ì‚¬ìš© ]</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">time</span><span class="o">,</span> <span class="nn">os</span>
<span class="kn">from</span> <span class="nn">multiprocessing</span> <span class="kn">import</span> <span class="n">Pool</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>ê³¼ì œ I</strong></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong><code>ê³¼ì œI</code></strong> ì€ ì•ì˜ ë°©ë²•ê³¼ ê°™ìœ¼ë¯€ë¡œ ìƒëµí•œë‹¤.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">'ìƒì¥ì¼ 2018-01-01 ì´ì „ ì¢…ëª©ì½”ë“œ: '</span><span class="p">,</span> <span class="n">lst_code</span><span class="p">[:</span><span class="mi">4</span><span class="p">])</span>
<span class="nb">print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">'ì´ </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">df_code</span><span class="p">)</span><span class="si">}</span><span class="s1"> ê°œì˜ ì¢…ëª© ì¤‘ </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">lst_code</span><span class="p">)</span><span class="si">}</span><span class="s1"> ê°œì˜ ì¢…ëª© ì„ ë³„'</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>ìƒì¥ì¼ 2018-01-01 ì´ì „ ì¢…ëª©ì½”ë“œ:  ['000210', '004840', '155660', '078930']

ì´ 2507 ê°œì˜ ì¢…ëª© ì¤‘ 1977 ê°œì˜ ì¢…ëª© ì„ ë³„
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>ê³¼ì œ II</strong></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>
<code>multi processing</code>ì„ ìœ„í•œ í•¨ìˆ˜ ì •ì˜ </li>
</ul>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">make_lst_result</span><span class="p">(</span><span class="n">code</span><span class="p">):</span> 
    <span class="n">start_date</span> <span class="o">=</span> <span class="s1">'20180101'</span>
    <span class="n">end_date</span> <span class="o">=</span> <span class="s1">'20201231'</span>
    
    <span class="n">lst_date</span> <span class="o">=</span> <span class="p">[]</span>
    
    <span class="n">stock</span> <span class="o">=</span> <span class="n">fdr</span><span class="o">.</span><span class="n">DataReader</span><span class="p">(</span><span class="n">code</span><span class="p">,</span> <span class="n">start</span> <span class="o">=</span> <span class="n">start_date</span><span class="p">,</span> <span class="n">end</span> <span class="o">=</span> <span class="n">end_date</span><span class="p">)</span>
    <span class="n">stock</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
  
    <span class="c1"># ğŸŒŸ dataframe -&gt; list</span>
    <span class="n">lst_stock</span> <span class="o">=</span> <span class="n">stock</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
    
    <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">lst_stock</span><span class="p">:</span> 
        <span class="k">if</span> <span class="n">row</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">*</span> <span class="n">row</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">100000000000</span><span class="p">:</span> 
            <span class="n">lst_date</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">date</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">"%Y%m</span><span class="si">%d</span><span class="s2">"</span><span class="p">))</span>
        
    <span class="k">return</span> <span class="p">[</span><span class="n">code</span><span class="p">,</span> <span class="n">lst_date</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>
<code>multi processing</code> ìˆ˜í–‰</li>
</ul>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="n">num_cores</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">pool</span> <span class="o">=</span> <span class="n">Pool</span><span class="p">(</span><span class="n">num_cores</span><span class="p">)</span>
<span class="n">lst_code_date</span> <span class="o">=</span> <span class="n">pool</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">make_lst_result</span><span class="p">,</span> <span class="n">lst_code</span><span class="p">)</span>
<span class="n">pool</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="n">pool</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span><span class="p">)</span> 
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>17.97966194152832
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>ì•ì„œ ì•½ 2ë¶„ 40ì´ˆ ê°€ ê±¸ë ¸ë˜ <strong><code>ê³¼ì œII</code></strong> ë¥¼ <code>multi processing</code>ì„ ì‚¬ìš©í•˜ì—¬ 17ì´ˆëŒ€ë¡œ ë‹¨ì¶•ì‹œì¼°ë‹¤.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>
<code>dictionary</code> ìƒì„± </li>
</ul>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dict_code2date</span> <span class="o">=</span> <span class="p">{}</span>

<span class="k">for</span> <span class="n">code</span><span class="p">,</span> <span class="n">lst_date</span>  <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="n">lst_code_date</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">lst_date</span> <span class="o">==</span> <span class="p">[]:</span>
        <span class="k">continue</span>
    <span class="n">dict_code2date</span><span class="p">[</span><span class="n">code</span><span class="p">]</span> <span class="o">=</span> <span class="n">lst_date</span>
            
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">'ì´ </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">lst_code</span><span class="p">)</span><span class="si">}</span><span class="s1"> ê°œì˜ ì¢…ëª© ì¤‘ </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">dict_code2date</span><span class="p">)</span><span class="si">}</span><span class="s1"> ê°œì˜ ì¢…ëª© ì‚¬ìš©'</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1977/1977 [00:00&lt;00:00, 1610124.08it/s]</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>ì´ 1977 ê°œì˜ ì¢…ëª© ì¤‘ 799 ê°œì˜ ì¢…ëª© ì‚¬ìš©
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>ê³¼ì œ III</strong></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>
<code>multi processing</code>ì„ ìœ„í•œ í•¨ìˆ˜ ì •ì˜ </li>
</ul>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">make_lst_result2</span><span class="p">(</span><span class="n">code</span><span class="p">):</span> 
    <span class="c1"># codeì˜ stock </span>
    <span class="n">start_date</span> <span class="o">=</span> <span class="s1">'20180101'</span> 
    <span class="n">end_date</span> <span class="o">=</span> <span class="s1">'20201231'</span> 
    <span class="n">stock</span> <span class="o">=</span> <span class="n">fdr</span><span class="o">.</span><span class="n">DataReader</span><span class="p">(</span><span class="n">code</span><span class="p">,</span> <span class="n">start</span> <span class="o">=</span> <span class="n">start_date</span><span class="p">,</span> <span class="n">end</span> <span class="o">=</span> <span class="n">end_date</span><span class="p">)</span>
    <span class="n">stock</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    
    <span class="c1"># ğŸŒŸ dataframe -&gt; list     </span>
    <span class="n">lst_stock</span> <span class="o">=</span> <span class="n">stock</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>  
       
    <span class="n">lst_result</span> <span class="o">=</span> <span class="p">[]</span>
        
    <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">lst_stock</span><span class="p">):</span> 
        
        <span class="k">if</span> <span class="p">(</span><span class="n">idx</span> <span class="o">&lt;</span> <span class="mi">9</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">idx</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="n">lst_stock</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span> <span class="c1"># ì˜ˆì™¸ ì²˜ë¦¬ </span>
            <span class="k">continue</span> 
            
        <span class="n">date</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">date</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">"%Y%m</span><span class="si">%d</span><span class="s2">"</span><span class="p">)</span> 
        <span class="k">if</span> <span class="n">date</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">dict_code2date</span><span class="p">[</span><span class="n">code</span><span class="p">]:</span> <span class="c1"># ì¡°ê±´ì— ë¶€í•©í•˜ëŠ” ë‚ ì§œ (D0 ë‚ ì§œ)ë¥¼ ë°œê²¬í•  ë•Œê¹Œì§€ continue</span>
            <span class="k">continue</span> 

        <span class="c1"># D-9 ~ D0 ë°ì´í„°ë§Œ ë‹´ê¸°</span>
        <span class="n">sub_stock</span> <span class="o">=</span> <span class="n">lst_stock</span><span class="p">[</span><span class="n">idx</span><span class="o">-</span><span class="mi">9</span><span class="p">:</span><span class="n">idx</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> 
        
        <span class="c1"># 10ì¼ê°„ì˜ ë°ì´í„° </span>
        <span class="n">lst_info</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">row2</span> <span class="ow">in</span> <span class="n">sub_stock</span><span class="p">:</span>
            <span class="n">lst_prices</span><span class="p">,</span> <span class="n">trading_value</span> <span class="o">=</span> <span class="n">row2</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">5</span><span class="p">],</span> <span class="n">row2</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">*</span><span class="n">row2</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span>
            <span class="n">lst_info</span> <span class="o">+=</span> <span class="n">lst_prices</span> <span class="o">+</span> <span class="p">[</span><span class="n">trading_value</span><span class="p">]</span>
        <span class="n">info</span> <span class="o">=</span> <span class="s1">','</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">lst_info</span><span class="p">))</span>

        <span class="c1"># D+1 ì¢…ê°€ 2% ìƒìŠ¹ ì—¬ë¶€ </span>
        <span class="n">label</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">lst_stock</span><span class="p">[</span><span class="n">idx</span><span class="o">+</span><span class="mi">1</span><span class="p">][</span><span class="mi">6</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mf">0.02</span><span class="p">)</span>
        
        <span class="n">lst_result</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">code</span><span class="p">,</span> <span class="n">date</span><span class="p">,</span> <span class="n">info</span><span class="p">,</span> <span class="n">label</span><span class="p">])</span>
        
    <span class="k">return</span> <span class="n">lst_result</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>
<code>multi processing</code> ìˆ˜í–‰</li>
</ul>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="n">num_cores</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">pool</span> <span class="o">=</span> <span class="n">Pool</span><span class="p">(</span><span class="n">num_cores</span><span class="p">)</span>
<span class="n">lst_data</span> <span class="o">=</span> <span class="n">pool</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">make_lst_result2</span><span class="p">,</span> <span class="n">dict_code2date</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
<span class="n">pool</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="n">pool</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span><span class="p">)</span> 
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>8.186521768569946
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>ì•ì„œ ì§„í–‰í–ˆë˜ ë°©ë²•ì—ì„œ 1ë¶„ì´ ê±¸ë ¸ë˜ ì‘ì—…ì´ <code>multi processing</code>ì„ í†µí•˜ì—¬ 8ì´ˆë¡œ ì¤„ì–´ë“¤ì—ˆë‹¤.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>
<code>txt</code> íŒŒì¼ ìƒì„± </li>
</ul>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">OF</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s2">"assignment3_multi_processing.txt"</span><span class="p">,</span> <span class="s1">'w'</span><span class="p">)</span>

<span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">lst_data</span><span class="p">:</span> 
    <span class="k">for</span> <span class="n">num</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">row</span><span class="p">)):</span> 
        <span class="n">OF</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">'</span><span class="se">\t</span><span class="s1">'</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">row</span><span class="p">[</span><span class="n">num</span><span class="p">]))</span> <span class="o">+</span> <span class="s1">'</span><span class="se">\n</span><span class="s1">'</span><span class="p">)</span>
        
<span class="n">OF</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">'ìƒì„±ëœ ë°ì´í„°ì˜ ê°œìˆ˜ëŠ” </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">"assignment3_multi_processing.txt"</span><span class="p">))</span><span class="si">}</span><span class="s1"> ê°œ'</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>ìƒì„±ëœ ë°ì´í„°ì˜ ê°œìˆ˜ëŠ” 13939 ê°œ
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<hr>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="âœ”ï¸-(4)-Finance-Data-Readerë¥¼-ì´ìš©í•œ-ì£¼ê°€-ë°ì´í„°ì…‹---MySQL">
<a class="anchor" href="#%E2%9C%94%EF%B8%8F-(4)-Finance-Data-Reader%EB%A5%BC-%EC%9D%B4%EC%9A%A9%ED%95%9C-%EC%A3%BC%EA%B0%80-%EB%8D%B0%EC%9D%B4%ED%84%B0%EC%85%8B---MySQL" aria-hidden="true"><span class="octicon octicon-link"></span></a>âœ”ï¸ <strong>(4)</strong> Finance Data Readerë¥¼ ì´ìš©í•œ ì£¼ê°€ ë°ì´í„°ì…‹ - <code>MySQL</code><a class="anchor-link" href="#%E2%9C%94%EF%B8%8F-(4)-Finance-Data-Reader%EB%A5%BC-%EC%9D%B4%EC%9A%A9%ED%95%9C-%EC%A3%BC%EA%B0%80-%EB%8D%B0%EC%9D%B4%ED%84%B0%EC%85%8B---MySQL"> </a>
</h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>4ë²ˆì§¸ ë°©ë²•ì€ <code>MySQL</code>ì„ ì‚¬ìš©í•œë‹¤. ì™¸ë¶€ ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ì§€ ì•Šì•„ë„ ë˜ê³ , ì„œë²„ <code>DB</code>ì— ì €ì¥ëœ ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ê²ƒì´ë¯€ë¡œ <code>multi processing</code>ì„ ì‚¬ìš©í•˜ì§€ ì•Šê³ ë„ ë¹ ë¥¸ ì†ë„ë¡œ ë°ì´í„°ì…‹ì„ ìƒì„±í•  ìˆ˜ ìˆë‹¤.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>ê³¼ì œ I</strong></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>ìµœì¢…ì ìœ¼ë¡œ ë¨¸ì‹ ëŸ¬ë‹ ë¶„ì„ì— ì‚¬ìš©í•  ë°ì´í„°ì…‹ì€ ì½”ìŠ¤í”¼, ì½”ìŠ¤ë‹¥ ì‹œì¥ì— í•´ë‹¹í•˜ëŠ” ì¢…ëª©ë“¤ë§Œì„ ì‚¬ìš©í•œë‹¤. í˜„ì¬ <code>db</code>ì— ì €ì¥ë˜ì–´ ìˆëŠ” ë°ì´í„°ë„ ì½”ìŠ¤í”¼, ì½”ìŠ¤ë‹¥ ì‹œì¥ì— í•´ë‹¹í•˜ëŠ” ì¢…ëª©ë“¤ì´ ì…ë ¥ë˜ì–´ ìˆìœ¼ë©°, í•´ë‹¹ ì¢…ëª©ë“¤ì„ ì¶”ë¦° <code>code_list.txt</code>ì—ì„œ ì¢…ëª©ë“¤ì„ ë¶ˆëŸ¬ì™€ <code>lst_code</code>ë¥¼ ì‚¬ìš©í•œë‹¤.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">IF</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s1">'../data/code_list.txt'</span><span class="p">)</span>
<span class="n">lst_code</span> <span class="o">=</span> <span class="n">IF</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">'ì´ </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">df_code</span><span class="p">)</span><span class="si">}</span><span class="s1"> ê°œì˜ ì¢…ëª© ì¤‘ </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">lst_code</span><span class="p">)</span><span class="si">}</span><span class="s1"> ê°œì˜ ì¢…ëª© ì„ ë³„'</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>ì´ 2507 ê°œì˜ ì¢…ëª© ì¤‘ 1561 ê°œì˜ ì¢…ëª© ì„ ë³„
</pre>
</div>
</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># ! pip install pymysql</span>

<span class="kn">import</span> <span class="nn">pymysql</span> 
<span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="kn">import</span> <span class="n">create_engine</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>
<strong><code>MySQL</code> ë°ì´í„° ì €ì¥</strong> (<code>dataframe</code> -&gt; <code>sql</code>) <br>
</li>
</ul>
<p><code>code</code> ë³„ë¡œ ë‹¤ë¥¸ í…Œì´ë¸”ì— ì €ì¥í•œë‹¤.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">db_connection_str</span> <span class="o">=</span> <span class="s1">'mysql+pymysql://[db username]:[db password]@[host address]/[db name]'</span> 
<span class="n">db_connection</span> <span class="o">=</span> <span class="n">create_engine</span><span class="p">(</span><span class="n">db_connection_str</span><span class="p">)</span>
<span class="n">conn</span> <span class="o">=</span> <span class="n">db_connection</span><span class="o">.</span><span class="n">connect</span><span class="p">()</span>

<span class="k">for</span> <span class="n">code</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="n">lst_code</span><span class="p">):</span> 
    <span class="n">start_date</span> <span class="o">=</span> <span class="s1">'20170101'</span>
    <span class="n">end_date</span> <span class="o">=</span> <span class="s1">'20211231'</span>
    <span class="n">stock</span> <span class="o">=</span> <span class="n">fdr</span><span class="o">.</span><span class="n">DataReader</span><span class="p">(</span><span class="n">code</span><span class="p">,</span> <span class="n">start</span> <span class="o">=</span> <span class="n">start_date</span><span class="p">,</span> <span class="n">end</span> <span class="o">=</span> <span class="n">end_date</span><span class="p">)</span>
    <span class="n">stock</span> <span class="o">=</span> <span class="n">stock</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
    <span class="n">stock</span> <span class="o">=</span> <span class="n">stock</span><span class="p">[[</span><span class="s1">'Date'</span><span class="p">,</span> <span class="s1">'Open'</span><span class="p">,</span> <span class="s1">'High'</span><span class="p">,</span> <span class="s1">'Low'</span><span class="p">,</span> <span class="s1">'Close'</span><span class="p">,</span> <span class="s1">'Volume'</span><span class="p">,</span> <span class="s1">'Change'</span><span class="p">]]</span>
    <span class="n">stock</span><span class="o">.</span><span class="n">to_sql</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="sa">f</span><span class="s1">'stock_</span><span class="si">{</span><span class="n">code</span><span class="si">}</span><span class="s1">'</span><span class="p">,</span> <span class="n">con</span><span class="o">=</span><span class="n">db_connection</span><span class="p">,</span> <span class="n">if_exists</span><span class="o">=</span><span class="s1">'fail'</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>
<strong><code>MySQL</code> ì—ì„œ ë°ì´í„° ë¶ˆëŸ¬ì˜¨ í›„ ë°ì´í„°ì…‹ ìƒì„±</strong> </li>
</ul>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">db_dsml</span> <span class="o">=</span> <span class="n">pymysql</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
    <span class="n">host</span> <span class="o">=</span> <span class="s1">'localhost'</span><span class="p">,</span> 
    <span class="n">port</span> <span class="o">=</span> <span class="mi">3306</span><span class="p">,</span> 
    <span class="n">user</span> <span class="o">=</span> <span class="s1">'[db username]'</span><span class="p">,</span> 
    <span class="n">passwd</span> <span class="o">=</span> <span class="s1">'[db password]'</span><span class="p">,</span> 
    <span class="n">db</span> <span class="o">=</span> <span class="s1">'[db name]'</span><span class="p">,</span> 
    <span class="n">charset</span> <span class="o">=</span> <span class="s1">'utf8'</span>
<span class="p">)</span>
<span class="n">cursor</span> <span class="o">=</span> <span class="n">db_dsml</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>ê³¼ì œ II</strong></p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dict_code2date</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">code</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="n">lst_code</span><span class="p">):</span> 
    <span class="n">code</span> <span class="o">=</span> <span class="n">code</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
    <span class="n">sql_query</span> <span class="o">=</span> <span class="s1">'''</span>
<span class="s1">                SELECT *</span>
<span class="s1">                FROM stock_</span><span class="si">{}</span><span class="s1"></span>
<span class="s1">                WHERE Date BETWEEN '2018-01-01' AND '2020-12-31'</span>
<span class="s1">                '''</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">code</span><span class="p">)</span>
    <span class="n">stock</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_sql</span><span class="p">(</span><span class="n">sql</span> <span class="o">=</span> <span class="n">sql_query</span><span class="p">,</span> <span class="n">con</span> <span class="o">=</span> <span class="n">db_dsml</span><span class="p">)</span>   
    
    <span class="c1"># ğŸŒŸ dataframe -&gt; list     </span>
    <span class="n">lst_stock</span> <span class="o">=</span> <span class="n">stock</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
    
    <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">lst_stock</span><span class="p">:</span> 
        <span class="n">date</span><span class="p">,</span> <span class="n">trading_value</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">row</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">*</span><span class="n">row</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">trading_value</span> <span class="o">&gt;=</span> <span class="mi">100000000000</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">code</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">dict_code2date</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="n">dict_code2date</span><span class="p">[</span><span class="n">code</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">date</span><span class="o">.</span><span class="n">date</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">"%Y%m</span><span class="si">%d</span><span class="s2">"</span><span class="p">)]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">dict_code2date</span><span class="p">[</span><span class="n">code</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">date</span><span class="o">.</span><span class="n">date</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">"%Y%m</span><span class="si">%d</span><span class="s2">"</span><span class="p">))</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">'ì´ </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">lst_code</span><span class="p">)</span><span class="si">}</span><span class="s1"> ê°œì˜ ì¢…ëª© ì¤‘ </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">dict_code2date</span><span class="p">)</span><span class="si">}</span><span class="s1"> ê°œì˜ ì¢…ëª© ì‚¬ìš©'</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1561/1561 [00:22&lt;00:00, 69.07it/s]</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>ì´ 1561 ê°œì˜ ì¢…ëª© ì¤‘ 679 ê°œì˜ ì¢…ëª© ì‚¬ìš©
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>ê³¼ì œ III</strong></p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">OF</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s1">'assignment3_sql.txt'</span><span class="p">,</span> <span class="s1">'w'</span><span class="p">)</span>
<span class="k">for</span> <span class="n">code</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="n">dict_code2date</span><span class="p">):</span> 
    <span class="n">code</span> <span class="o">=</span> <span class="n">code</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
    <span class="n">sql_query</span> <span class="o">=</span> <span class="s1">'''</span>
<span class="s1">                SELECT *</span>
<span class="s1">                FROM stock_</span><span class="si">{}</span><span class="s1"></span>
<span class="s1">                WHERE Date BETWEEN '2018-01-01' AND '2020-12-31'</span>
<span class="s1">                '''</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">code</span><span class="p">)</span>
    <span class="n">stock</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_sql</span><span class="p">(</span><span class="n">sql</span> <span class="o">=</span> <span class="n">sql_query</span><span class="p">,</span> <span class="n">con</span> <span class="o">=</span> <span class="n">db_dsml</span><span class="p">)</span>  
    
    <span class="c1"># ğŸŒŸ dataframe -&gt; list     </span>
    <span class="n">lst_stock</span> <span class="o">=</span> <span class="n">stock</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>  
       
    <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">lst_stock</span><span class="p">):</span>   
        <span class="k">if</span> <span class="p">(</span><span class="n">idx</span> <span class="o">&lt;</span> <span class="mi">9</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">idx</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="n">lst_stock</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span> <span class="c1"># ì˜ˆì™¸ ì²˜ë¦¬ </span>
            <span class="k">continue</span> 
        
        <span class="n">date</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">date</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">"%Y%m</span><span class="si">%d</span><span class="s2">"</span><span class="p">)</span> 
        <span class="k">if</span> <span class="n">date</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">dict_code2date</span><span class="p">[</span><span class="n">code</span><span class="p">]:</span> <span class="c1"># ì¡°ê±´ì— ë¶€í•©í•˜ëŠ” ë‚ ì§œ (D0 ë‚ ì§œ)ë¥¼ ë°œê²¬í•  ë•Œê¹Œì§€ continue</span>
            <span class="k">continue</span> 

        <span class="c1"># D-9 ~ D0 ë°ì´í„°ë§Œ ë‹´ê¸°</span>
        <span class="n">sub_stock</span> <span class="o">=</span> <span class="n">lst_stock</span><span class="p">[</span><span class="n">idx</span><span class="o">-</span><span class="mi">9</span><span class="p">:</span><span class="n">idx</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> 
        
        <span class="c1"># 10ì¼ê°„ì˜ ë°ì´í„° </span>
        <span class="n">lst_info</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">row2</span> <span class="ow">in</span> <span class="n">sub_stock</span><span class="p">:</span>
            <span class="n">lst_prices</span><span class="p">,</span> <span class="n">trading_value</span> <span class="o">=</span> <span class="n">row2</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">5</span><span class="p">],</span> <span class="n">row2</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">*</span><span class="n">row2</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span>
            <span class="n">lst_info</span> <span class="o">+=</span> <span class="n">lst_prices</span> <span class="o">+</span> <span class="p">[</span><span class="n">trading_value</span><span class="p">]</span>
        <span class="n">info</span> <span class="o">=</span> <span class="s1">','</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">lst_info</span><span class="p">))</span>

        <span class="c1"># D+1 ì¢…ê°€ 2% ìƒìŠ¹ ì—¬ë¶€ </span>
        <span class="n">label</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">lst_stock</span><span class="p">[</span><span class="n">idx</span><span class="o">+</span><span class="mi">1</span><span class="p">][</span><span class="mi">6</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mf">0.02</span><span class="p">)</span>

        <span class="c1"># ì €ì¥ </span>
        <span class="n">OF</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s1">'</span><span class="si">{</span><span class="n">code</span><span class="si">}</span><span class="se">\t</span><span class="si">{</span><span class="n">date</span><span class="si">}</span><span class="se">\t</span><span class="si">{</span><span class="n">info</span><span class="si">}</span><span class="se">\t</span><span class="si">{</span><span class="n">label</span><span class="si">}</span><span class="se">\n</span><span class="s1">'</span><span class="p">)</span>
                         
<span class="n">OF</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>   

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">'ìƒì„±ëœ ë°ì´í„°ì˜ ê°œìˆ˜ëŠ” </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">"assignment3_sql.txt"</span><span class="p">))</span><span class="si">}</span><span class="s1"> ê°œ'</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 679/679 [00:11&lt;00:00, 61.46it/s]</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>ìƒì„±ëœ ë°ì´í„°ì˜ ê°œìˆ˜ëŠ” 11934 ê°œ
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<hr>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="âœ”ï¸-(5)-ìµœì¢…-ë¨¸ì‹ ëŸ¬ë‹-ë°ì´í„°ì…‹">
<a class="anchor" href="#%E2%9C%94%EF%B8%8F-(5)-%EC%B5%9C%EC%A2%85-%EB%A8%B8%EC%8B%A0%EB%9F%AC%EB%8B%9D-%EB%8D%B0%EC%9D%B4%ED%84%B0%EC%85%8B" aria-hidden="true"><span class="octicon octicon-link"></span></a>âœ”ï¸ <strong>(5)</strong> ìµœì¢… ë¨¸ì‹ ëŸ¬ë‹ ë°ì´í„°ì…‹<a class="anchor-link" href="#%E2%9C%94%EF%B8%8F-(5)-%EC%B5%9C%EC%A2%85-%EB%A8%B8%EC%8B%A0%EB%9F%AC%EB%8B%9D-%EB%8D%B0%EC%9D%B4%ED%84%B0%EC%85%8B"> </a>
</h3>
<p>ìµœì¢…ì ìœ¼ë¡œ ìƒì„±ëœ ë¨¸ì‹ ëŸ¬ë‹ ë°ì´í„°ì…‹ì˜ í˜•íƒœë¥¼ í™•ì¸í•œë‹¤.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">IF</span><span class="o">=</span><span class="nb">open</span><span class="p">(</span><span class="s2">"assignment3_sql.txt"</span><span class="p">,</span><span class="s1">'r'</span><span class="p">)</span>
<span class="n">lst_code_date</span><span class="o">=</span><span class="p">[]</span>
<span class="n">trainX</span><span class="o">=</span><span class="p">[]</span>
<span class="n">trainY</span><span class="o">=</span><span class="p">[]</span>
<span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">IF</span><span class="p">:</span>
    <span class="n">code</span><span class="p">,</span> <span class="n">date</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">"</span><span class="se">\t</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">lst_code_date</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">code</span><span class="p">,</span> <span class="n">date</span><span class="p">])</span>
    <span class="n">trainX</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">","</span><span class="p">))))</span>
    <span class="n">trainY</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">y</span><span class="p">))</span>
<span class="n">trainX</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">trainX</span><span class="p">)</span>
<span class="n">trainY</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">trainY</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">"===== trainX ====="</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"trainX shape:"</span><span class="p">,</span> <span class="n">trainX</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">trainX</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
<span class="nb">print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"===== trainY ====="</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"trainY shape:"</span><span class="p">,</span> <span class="n">trainY</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">trainY</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>===== trainX =====
trainX shape: (11935, 50)
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
      <th>6</th>
      <th>7</th>
      <th>8</th>
      <th>9</th>
      <th>...</th>
      <th>40</th>
      <th>41</th>
      <th>42</th>
      <th>43</th>
      <th>44</th>
      <th>45</th>
      <th>46</th>
      <th>47</th>
      <th>48</th>
      <th>49</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>10250</td>
      <td>12050</td>
      <td>10150</td>
      <td>11800</td>
      <td>307823874200</td>
      <td>11950</td>
      <td>12450</td>
      <td>10900</td>
      <td>11750</td>
      <td>240410569500</td>
      <td>...</td>
      <td>15300</td>
      <td>15400</td>
      <td>12650</td>
      <td>13700</td>
      <td>789063638200</td>
      <td>13700</td>
      <td>16100</td>
      <td>13400</td>
      <td>15400</td>
      <td>897154258000</td>
    </tr>
    <tr>
      <th>1</th>
      <td>11950</td>
      <td>12450</td>
      <td>10900</td>
      <td>11750</td>
      <td>240410569500</td>
      <td>11850</td>
      <td>14150</td>
      <td>11600</td>
      <td>12600</td>
      <td>764364560400</td>
      <td>...</td>
      <td>13700</td>
      <td>16100</td>
      <td>13400</td>
      <td>15400</td>
      <td>897154258000</td>
      <td>14700</td>
      <td>15500</td>
      <td>14000</td>
      <td>14350</td>
      <td>277027065700</td>
    </tr>
    <tr>
      <th>2</th>
      <td>11850</td>
      <td>14150</td>
      <td>11600</td>
      <td>12600</td>
      <td>764364560400</td>
      <td>12800</td>
      <td>13200</td>
      <td>12000</td>
      <td>12200</td>
      <td>170010147600</td>
      <td>...</td>
      <td>14700</td>
      <td>15500</td>
      <td>14000</td>
      <td>14350</td>
      <td>277027065700</td>
      <td>13050</td>
      <td>13300</td>
      <td>11650</td>
      <td>11650</td>
      <td>231873876050</td>
    </tr>
    <tr>
      <th>3</th>
      <td>12800</td>
      <td>13200</td>
      <td>12000</td>
      <td>12200</td>
      <td>170010147600</td>
      <td>12450</td>
      <td>13400</td>
      <td>12350</td>
      <td>12850</td>
      <td>211661434950</td>
      <td>...</td>
      <td>13050</td>
      <td>13300</td>
      <td>11650</td>
      <td>11650</td>
      <td>231873876050</td>
      <td>12200</td>
      <td>13150</td>
      <td>11600</td>
      <td>12200</td>
      <td>222393934200</td>
    </tr>
    <tr>
      <th>4</th>
      <td>12450</td>
      <td>13400</td>
      <td>12350</td>
      <td>12850</td>
      <td>211661434950</td>
      <td>12800</td>
      <td>12950</td>
      <td>11300</td>
      <td>11700</td>
      <td>91801277100</td>
      <td>...</td>
      <td>12200</td>
      <td>13150</td>
      <td>11600</td>
      <td>12200</td>
      <td>222393934200</td>
      <td>12200</td>
      <td>13750</td>
      <td>12100</td>
      <td>12350</td>
      <td>256196958550</td>
    </tr>
  </tbody>
</table>
<p>5 rows Ã— 50 columns</p>
</div>
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>
===== trainY =====
trainY shape: (11935, 1)
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>
<code>kospi</code> + <code>kosdaq</code> ì£¼ì‹ ì‹œì¥, <code>3ë…„</code> ì´ìƒ ì¡´ì†í•˜ì˜€ë˜ ì¢…ëª©ë“¤ì„ ê±°ë˜ëŒ€ê¸ˆ <code>1000ì–µ</code> ì´ìƒì˜ ì¡°ê±´ìœ¼ë¡œ ì„¤ì •í•˜ê³ , <code>10ì¼</code> ê°„ì˜ ë°ì´í„°ë“¤ì„ <code>feature</code>ë¡œ ë‘ì–´ ìƒì„±í•œ ìµœì¢… ë¨¸ì‹ ëŸ¬ë‹ ë°ì´í„°ì…‹ì€ <code>11935</code> X <code>50</code> ì˜ í¬ê¸°ê°€ ë‚˜ì™”ë‹¤. </li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<hr>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>4ë‹¨ê³„ì˜ ê³¼ì •ì„ ê±°ì³ ë¨¸ì‹ ëŸ¬ë‹ ë°ì´í„°ì…‹ ìƒì„±ì„ ë§ˆì³¤ë‹¤. ë‹¤ìŒ ê¸€ì—ì„œëŠ” ìƒì„±ëœ ë¨¸ì‹ ëŸ¬ë‹ ë°ì´í„°ì…‹ì„ ì‚¬ìš©í•˜ì—¬ ì—¬ëŸ¬ ë¨¸ì‹ ëŸ¬ë‹ ëª¨ë¸ì„ í•™ìŠµ ë° í‰ê°€í•˜ì—¬ ì„±ëŠ¥ì´ ê°€ì¥ ì¢‹ì€ ëª¨ë¸ì„ ì„ ì •í•˜ëŠ” <code>baseline model selection</code>ì„ ì§„í–‰í•œë‹¤.</p>

</div>
</div>
</div>
</div>



  </div><!-- from https://github.com/utterance/utterances -->
<script src="https://utteranc.es/client.js"
        repo="eunsukim06/blog"
        issue-term="title"
        label="blogpost-comment"
        theme="github-light"
        crossorigin="anonymous"
        async>
</script><a class="u-url" href="/blog/stock%20prediction/2022/07/07/stock-dataset.html" hidden></a>
</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/blog/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col">
        <p class="feed-subscribe">
          <a href="/blog/feed.xml">
            <svg class="svg-icon orange">
              <use xlink:href="/blog/assets/minima-social-icons.svg#rss"></use>
            </svg><span>Subscribe</span>
          </a>
        </p>
      </div>
      <div class="footer-col">
        <p>An easy to use blogging platform with support for Jupyter Notebooks.</p>
      </div>
    </div>

    <div class="social-links"><ul class="social-media-list"><li><a rel="me" href="https://github.com/fastai" target="_blank" title="fastai"><svg class="svg-icon grey"><use xlink:href="/blog/assets/minima-social-icons.svg#github"></use></svg></a></li><li><a rel="me" href="https://twitter.com/fastdotai" target="_blank" title="fastdotai"><svg class="svg-icon grey"><use xlink:href="/blog/assets/minima-social-icons.svg#twitter"></use></svg></a></li></ul>
</div>

  </div>

</footer>
</body>

</html>
